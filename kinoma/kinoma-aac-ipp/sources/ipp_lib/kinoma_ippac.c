/*
 *     Copyright (C) 2010-2015 Marvell International Ltd.
 *     Copyright (C) 2002-2010 Kinoma, Inc.
 *
 *     Licensed under the Apache License, Version 2.0 (the "License");
 *     you may not use this file except in compliance with the License.
 *     You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *     Unless required by applicable law or agreed to in writing, software
 *     distributed under the License is distributed on an "AS IS" BASIS,
 *     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *     See the License for the specific language governing permissions and
 *     limitations under the License.
 */
/* some ippac functions which used in Intel aac and mp3 sample code */

#ifdef __KINOMA_IPP__

#include "ippac.h"
#include "kinoma_ipps.h"
#include "kinoma_ipp_common.h"

#ifdef PRINT_REF_INFO
#include "dump.h"
#endif


#ifdef KINOMA_SYNTH

static const double fastFilter[] =		/*filters of Nik, about half coeffs of full coeffs for fast IMDCT */
{
 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
 0.671558955, -0.803207531, -0.514102744,  0.903989293, 0.336889853, -0.970031253, -0.146730474,  0.998795456,
-0.049067674, -0.989176510,  0.242980180,  0.941544065,-0.427555093, -0.857728610,  0.595699304,  0.740951125,
-0.740951125, -0.595699304,  0.857728610,  0.427555093,-0.941544065, -0.242980180,  0.989176510,  0.049067674,
-0.998795456,  0.146730474,  0.970031253, -0.336889853,-0.903989293,  0.514102744,  0.803207531, -0.671558955,
 0.634393284, -0.881921264, -0.290284677,  0.995184727,-0.098017140, -0.956940336,  0.471396737,  0.773010453,
-0.773010453, -0.471396737,  0.956940336,  0.098017140,-0.995184727,  0.290284677,  0.881921264, -0.634393284,
-0.634393284,  0.881921264,  0.290284677, -0.995184727, 0.098017140,  0.956940336, -0.471396737, -0.773010453,
 0.773010453,  0.471396737, -0.956940336, -0.098017140, 0.995184727, -0.290284677, -0.881921264,  0.634393284,
 0.595699304, -0.941544065, -0.049067674,  0.970031253,-0.514102744, -0.671558955,  0.903989293,  0.146730474,
-0.989176510,  0.427555093,  0.740951125, -0.857728610,-0.242980180,  0.998795456, -0.336889853, -0.803207531,
 0.803207531,  0.336889853, -0.998795456,  0.242980180, 0.857728610, -0.740951125, -0.427555093,  0.989176510,
-0.146730474, -0.903989293,  0.671558955,  0.514102744,-0.970031253,  0.049067674,  0.941544065, -0.595699304,
 0.555570233, -0.980785280,  0.195090322,  0.831469612,-0.831469612, -0.195090322,  0.980785280, -0.555570233,
-0.555570233,  0.980785280, -0.195090322, -0.831469612, 0.831469612,  0.195090322, -0.980785280,  0.555570233,
 0.555570233, -0.980785280,  0.195090322,  0.831469612,-0.831469612, -0.195090322,  0.980785280, -0.555570233,
-0.555570233,  0.980785280, -0.195090322, -0.831469612, 0.831469612,  0.195090322, -0.980785280,  0.555570233,
 0.514102744, -0.998795456,  0.427555093,  0.595699304,-0.989176510,  0.336889853,  0.671558955, -0.970031253,
 0.242980180,  0.740951125, -0.941544065,  0.146730474, 0.803207531, -0.903989293,  0.049067674,  0.857728610,
-0.857728610, -0.049067674,  0.903989293, -0.803207531,-0.146730474,  0.941544065, -0.740951125, -0.242980180,
 0.970031253, -0.671558955, -0.336889853,  0.989176510,-0.595699304, -0.427555093,  0.998795456, -0.514102744,
 0.471396737, -0.995184727,  0.634393284,  0.290284677,-0.956940336,  0.773010453,  0.098017140, -0.881921264,
 0.881921264, -0.098017140, -0.773010453,  0.956940336,-0.290284677, -0.634393284,  0.995184727, -0.471396737,
-0.471396737,  0.995184727, -0.634393284, -0.290284677, 0.956940336, -0.773010453, -0.098017140,  0.881921264,
-0.881921264,  0.098017140,  0.773010453, -0.956940336, 0.290284677,  0.634393284, -0.995184727,  0.471396737,
 0.427555093, -0.970031253,  0.803207531, -0.049067674,-0.740951125,  0.989176510, -0.514102744, -0.336889853,
 0.941544065, -0.857728610,  0.146730474,  0.671558955,-0.998795456,  0.595699304,  0.242980180, -0.903989293,
 0.903989293, -0.242980180, -0.595699304,  0.998795456,-0.671558955, -0.146730474,  0.857728610, -0.941544065,
 0.336889853,  0.514102744, -0.989176510,  0.740951125, 0.049067674, -0.803207531,  0.970031253, -0.427555093,
 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
 0.336889853, -0.857728610,  0.989176510, -0.671558955, 0.049067674,  0.595699304, -0.970031253,  0.903989293,
-0.427555093, -0.242980180,  0.803207531, -0.998795456, 0.740951125, -0.146730474, -0.514102744,  0.941544065,
-0.941544065,  0.514102744,  0.146730474, -0.740951125, 0.998795456, -0.803207531,  0.242980180,  0.427555093,
-0.903989293,  0.970031253, -0.595699304, -0.049067674, 0.671558955, -0.989176510,  0.857728610, -0.336889853,
 0.290284677, -0.773010453,  0.995184727, -0.881921264, 0.471396737,  0.098017140, -0.634393284,  0.956940336,
-0.956940336,  0.634393284, -0.098017140, -0.471396737, 0.881921264, -0.995184727,  0.773010453, -0.290284677,
-0.290284677,  0.773010453, -0.995184727,  0.881921264,-0.471396737, -0.098017140,  0.634393284, -0.956940336,
 0.956940336, -0.634393284,  0.098017140,  0.471396737,-0.881921264,  0.995184727, -0.773010453,  0.290284677,
 0.242980180, -0.671558955,  0.941544065, -0.989176510, 0.803207531, -0.427555093, -0.049067674,  0.514102744,
-0.857728610,  0.998795456, -0.903989293,  0.595699304,-0.146730474, -0.336889853,  0.740951125, -0.970031253,
 0.970031253, -0.740951125,  0.336889853,  0.146730474,-0.595699304,  0.903989293, -0.998795456,  0.857728610,
-0.514102744,  0.049067674,  0.427555093, -0.803207531, 0.989176510, -0.941544065,  0.671558955, -0.242980180,
 0.195090322, -0.555570233,  0.831469612, -0.980785280, 0.980785280, -0.831469612,  0.555570233, -0.195090322,
-0.195090322,  0.555570233, -0.831469612,  0.980785280,-0.980785280,  0.831469612, -0.555570233,  0.195090322,
 0.195090322, -0.555570233,  0.831469612, -0.980785280, 0.980785280, -0.831469612,  0.555570233, -0.195090322,
-0.195090322,  0.555570233, -0.831469612,  0.980785280,-0.980785280,  0.831469612, -0.555570233,  0.195090322,
 0.146730474, -0.427555093,  0.671558955, -0.857728610, 0.970031253, -0.998795456,  0.941544065, -0.803207531,
 0.595699304, -0.336889853,  0.049067674,  0.242980180,-0.514102744,  0.740951125, -0.903989293,  0.989176510,
-0.989176510,  0.903989293, -0.740951125,  0.514102744,-0.242980180, -0.049067674,  0.336889853, -0.595699304,
 0.803207531, -0.941544065,  0.998795456, -0.970031253, 0.857728610, -0.671558955,  0.427555093, -0.146730474,
 0.098017140, -0.290284677,  0.471396737, -0.634393284, 0.773010453, -0.881921264,  0.956940336, -0.995184727,
 0.995184727, -0.956940336,  0.881921264, -0.773010453, 0.634393284, -0.471396737,  0.290284677, -0.098017140,
-0.098017140,  0.290284677, -0.471396737,  0.634393284,-0.773010453,  0.881921264, -0.956940336,  0.995184727,
-0.995184727,  0.956940336, -0.881921264,  0.773010453,-0.634393284,  0.471396737, -0.290284677,  0.098017140,
 0.049067674, -0.146730474,  0.242980180, -0.336889853, 0.427555093, -0.514102744,  0.595699304, -0.671558955,
 0.740951125, -0.803207531,  0.857728610, -0.903989293, 0.941544065, -0.970031253,  0.989176510, -0.998795456,
 0.998795456, -0.989176510,  0.970031253, -0.941544065, 0.903989293, -0.857728610,  0.803207531, -0.740951125,
 0.671558955, -0.595699304,  0.514102744, -0.427555093, 0.336889853, -0.242980180,  0.146730474, -0.049067674,
-0.740951125,  0.595699304,  0.857728610, -0.427555093,-0.941544065,  0.242980180,  0.989176510, -0.049067674,
-0.998795456, -0.146730474,  0.970031253,  0.336889853,-0.903989293, -0.514102744,  0.803207531,  0.671558955,
-0.671558955, -0.803207531,  0.514102744,  0.903989293,-0.336889853, -0.970031253,  0.146730474,  0.998795456,
 0.049067674, -0.989176510, -0.242980180,  0.941544065, 0.427555093, -0.857728610, -0.595699304,  0.740951125,
-0.773010453,  0.471396737,  0.956940336, -0.098017140,-0.995184727, -0.290284677,  0.881921264,  0.634393284,
-0.634393284, -0.881921264,  0.290284677,  0.995184727, 0.098017140, -0.956940336, -0.471396737,  0.773010453,
 0.773010453, -0.471396737, -0.956940336,  0.098017140, 0.995184727,  0.290284677, -0.881921264, -0.634393284,
 0.634393284,  0.881921264, -0.290284677, -0.995184727,-0.098017140,  0.956940336,  0.471396737, -0.773010453,
-0.803207531,  0.336889853,  0.998795456,  0.242980180,-0.857728610, -0.740951125,  0.427555093,  0.989176510,
 0.146730474, -0.903989293, -0.671558955,  0.514102744, 0.970031253,  0.049067674, -0.941544065, -0.595699304,
 0.595699304,  0.941544065, -0.049067674, -0.970031253,-0.514102744,  0.671558955,  0.903989293, -0.146730474,
-0.989176510, -0.427555093,  0.740951125,  0.857728610,-0.242980180, -0.998795456, -0.336889853,  0.803207531,
-0.831469612,  0.195090322,  0.980785280,  0.555570233,-0.555570233, -0.980785280, -0.195090322,  0.831469612,
 0.831469612, -0.195090322, -0.980785280, -0.555570233, 0.555570233,  0.980785280,  0.195090322, -0.831469612,
-0.831469612,  0.195090322,  0.980785280,  0.555570233,-0.555570233, -0.980785280, -0.195090322,  0.831469612,
 0.831469612, -0.195090322, -0.980785280, -0.555570233, 0.555570233,  0.980785280,  0.195090322, -0.831469612,
-0.857728610,  0.049067674,  0.903989293,  0.803207531,-0.146730474, -0.941544065, -0.740951125,  0.242980180,
 0.970031253,  0.671558955, -0.336889853, -0.989176510,-0.595699304,  0.427555093,  0.998795456,  0.514102744,
-0.514102744, -0.998795456, -0.427555093,  0.595699304, 0.989176510,  0.336889853, -0.671558955, -0.970031253,
-0.242980180,  0.740951125,  0.941544065,  0.146730474,-0.803207531, -0.903989293, -0.049067674,  0.857728610,
-0.881921264, -0.098017140,  0.773010453,  0.956940336, 0.290284677, -0.634393284, -0.995184727, -0.471396737,
 0.471396737,  0.995184727,  0.634393284, -0.290284677,-0.956940336, -0.773010453,  0.098017140,  0.881921264,
 0.881921264,  0.098017140, -0.773010453, -0.956940336,-0.290284677,  0.634393284,  0.995184727,  0.471396737,
-0.471396737, -0.995184727, -0.634393284,  0.290284677, 0.956940336,  0.773010453, -0.098017140, -0.881921264,
-0.903989293, -0.242980180,  0.595699304,  0.998795456, 0.671558955, -0.146730474, -0.857728610, -0.941544065,
-0.336889853,  0.514102744,  0.989176510,  0.740951125,-0.049067674, -0.803207531, -0.970031253, -0.427555093,
 0.427555093,  0.970031253,  0.803207531,  0.049067674,-0.740951125, -0.989176510, -0.514102744,  0.336889853,
 0.941544065,  0.857728610,  0.146730474, -0.671558955,-0.998795456, -0.595699304,  0.242980180,  0.903989293,
-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
-0.941544065, -0.514102744,  0.146730474,  0.740951125, 0.998795456,  0.803207531,  0.242980180, -0.427555093,
-0.903989293, -0.970031253, -0.595699304,  0.049067674, 0.671558955,  0.989176510,  0.857728610,  0.336889853,
-0.336889853, -0.857728610, -0.989176510, -0.671558955,-0.049067674,  0.595699304,  0.970031253,  0.903989293,
 0.427555093, -0.242980180, -0.803207531, -0.998795456,-0.740951125, -0.146730474,  0.514102744,  0.941544065,
-0.956940336, -0.634393284, -0.098017140,  0.471396737, 0.881921264,  0.995184727,  0.773010453,  0.290284677,
-0.290284677, -0.773010453, -0.995184727, -0.881921264,-0.471396737,  0.098017140,  0.634393284,  0.956940336,
 0.956940336,  0.634393284,  0.098017140, -0.471396737,-0.881921264, -0.995184727, -0.773010453, -0.290284677,
 0.290284677,  0.773010453,  0.995184727,  0.881921264, 0.471396737, -0.098017140, -0.634393284, -0.956940336,
-0.970031253, -0.740951125, -0.336889853,  0.146730474, 0.595699304,  0.903989293,  0.998795456,  0.857728610,
 0.514102744,  0.049067674, -0.427555093, -0.803207531,-0.989176510, -0.941544065, -0.671558955, -0.242980180,
 0.242980180,  0.671558955,  0.941544065,  0.989176510, 0.803207531,  0.427555093, -0.049067674, -0.514102744,
-0.857728610, -0.998795456, -0.903989293, -0.595699304,-0.146730474,  0.336889853,  0.740951125,  0.970031253,
-0.980785280, -0.831469612, -0.555570233, -0.195090322, 0.195090322,  0.555570233,  0.831469612,  0.980785280,
 0.980785280,  0.831469612,  0.555570233,  0.195090322,-0.195090322, -0.555570233, -0.831469612, -0.980785280,
-0.980785280, -0.831469612, -0.555570233, -0.195090322, 0.195090322,  0.555570233,  0.831469612,  0.980785280,
 0.980785280,  0.831469612,  0.555570233,  0.195090322,-0.195090322, -0.555570233, -0.831469612, -0.980785280,
-0.989176510, -0.903989293, -0.740951125, -0.514102744,-0.242980180,  0.049067674,  0.336889853,  0.595699304,
 0.803207531,  0.941544065,  0.998795456,  0.970031253, 0.857728610,  0.671558955,  0.427555093,  0.146730474,
-0.146730474, -0.427555093, -0.671558955, -0.857728610,-0.970031253, -0.998795456, -0.941544065, -0.803207531,
-0.595699304, -0.336889853, -0.049067674,  0.242980180, 0.514102744,  0.740951125,  0.903989293,  0.989176510,
-0.995184727, -0.956940336, -0.881921264, -0.773010453,-0.634393284, -0.471396737, -0.290284677, -0.098017140,
 0.098017140,  0.290284677,  0.471396737,  0.634393284, 0.773010453,  0.881921264,  0.956940336,  0.995184727,
 0.995184727,  0.956940336,  0.881921264,  0.773010453, 0.634393284,  0.471396737,  0.290284677,  0.098017140,
-0.098017140, -0.290284677, -0.471396737, -0.634393284,-0.773010453, -0.881921264, -0.956940336, -0.995184727,
-0.998795456, -0.989176510, -0.970031253, -0.941544065,-0.903989293, -0.857728610, -0.803207531, -0.740951125,
-0.671558955, -0.595699304, -0.514102744, -0.427555093,-0.336889853, -0.242980180, -0.146730474, -0.049067674,
 0.049067674,  0.146730474,  0.242980180,  0.336889853, 0.427555093,  0.514102744,  0.595699304,  0.671558955,
 0.740951125,  0.803207531,  0.857728610,  0.903989293, 0.941544065,  0.970031253,  0.989176510,  0.998795456
};

static const double window[512] =		/*window for synth*/
{
 0.000000000, -0.000015259, -0.000015259, -0.000015259,-0.000015259, -0.000015259, -0.000015259, -0.000030518,
-0.000030518, -0.000030518, -0.000030518, -0.000045776,-0.000045776, -0.000061035, -0.000061035, -0.000076294,
-0.000076294, -0.000091553, -0.000106812, -0.000106812,-0.000122070, -0.000137329, -0.000152588, -0.000167847,
-0.000198364, -0.000213623, -0.000244141, -0.000259399,-0.000289917, -0.000320435, -0.000366211, -0.000396729,
-0.000442505, -0.000473022, -0.000534058, -0.000579834,-0.000625610, -0.000686646, -0.000747681, -0.000808716,
-0.000885010, -0.000961304, -0.001037598, -0.001113892,-0.001205444, -0.001296997, -0.001388550, -0.001480103,
-0.001586914, -0.001693726, -0.001785278, -0.001907349,-0.002014160, -0.002120972, -0.002243042, -0.002349854,
-0.002456665, -0.002578735, -0.002685547, -0.002792358,-0.002899170, -0.002990723, -0.003082275, -0.003173828,
 0.003250122,  0.003326416,  0.003387451,  0.003433228, 0.003463745,  0.003479004,  0.003479004,  0.003463745,
 0.003417969,  0.003372192,  0.003280640,  0.003173828, 0.003051758,  0.002883911,  0.002700806,  0.002487183,
 0.002227783,  0.001937866,  0.001617432,  0.001266479, 0.000869751,  0.000442505, -0.000030518, -0.000549316,
-0.001098633, -0.001693726, -0.002334595, -0.003005981,-0.003723145, -0.004486084, -0.005294800, -0.006118774,
-0.007003784, -0.007919312, -0.008865356, -0.009841919,-0.010848999, -0.011886597, -0.012939453, -0.014022827,
-0.015121460, -0.016235352, -0.017349243, -0.018463135,-0.019577026, -0.020690918, -0.021789551, -0.022857666,
-0.023910522, -0.024932861, -0.025909424, -0.026840210,-0.027725220, -0.028533936, -0.029281616, -0.029937744,
-0.030532837, -0.031005859, -0.031387329, -0.031661987,-0.031814575, -0.031845093, -0.031738281, -0.031478882,
 0.031082153,  0.030517578,  0.029785156,  0.028884888, 0.027801514,  0.026535034,  0.025085449,  0.023422241,
 0.021575928,  0.019531250,  0.017257690,  0.014801025, 0.012115479,  0.009231567,  0.006134033,  0.002822876,
-0.000686646, -0.004394531, -0.008316040, -0.012420654,-0.016708374, -0.021179199, -0.025817871, -0.030609131,
-0.035552979, -0.040634155, -0.045837402, -0.051132202,-0.056533813, -0.061996460, -0.067520142, -0.073059082,
-0.078628540, -0.084182739, -0.089706421, -0.095169067,-0.100540161, -0.105819702, -0.110946655, -0.115921021,
-0.120697021, -0.125259399, -0.129562378, -0.133590698,-0.137298584, -0.140670776, -0.143676758, -0.146255493,
-0.148422241, -0.150115967, -0.151306152, -0.151962280,-0.152069092, -0.151596069, -0.150497437, -0.148773193,
-0.146362305, -0.143264771, -0.139450073, -0.134887695,-0.129577637, -0.123474121, -0.116577148, -0.108856201,
 0.100311279,  0.090927124,  0.080688477,  0.069595337, 0.057617187,  0.044784546,  0.031082153,  0.016510010,
 0.001068115, -0.015228271, -0.032379150, -0.050354004,-0.069168091, -0.088775635, -0.109161377, -0.130310059,
-0.152206421, -0.174789429, -0.198059082, -0.221984863,-0.246505737, -0.271591187, -0.297210693, -0.323318481,
-0.349868774, -0.376800537, -0.404083252, -0.431655884,-0.459472656, -0.487472534, -0.515609741, -0.543823242,
-0.572036743, -0.600219727, -0.628295898, -0.656219482,-0.683914185, -0.711318970, -0.738372803, -0.765029907,
-0.791213989, -0.816864014, -0.841949463, -0.866363525,-0.890090942, -0.913055420, -0.935195923, -0.956481934,
-0.976852417, -0.996246338, -1.014617920, -1.031936646,-1.048156738, -1.063217163, -1.077117920, -1.089782715,
-1.101211548, -1.111373901, -1.120223999, -1.127746582,-1.133926392, -1.138763428, -1.142211914, -1.144287109,
 1.144989014,  1.144287109,  1.142211914,  1.138763428, 1.133926392,  1.127746582,  1.120223999,  1.111373901,
 1.101211548,  1.089782715,  1.077117920,  1.063217163, 1.048156738,  1.031936646,  1.014617920,  0.996246338,
 0.976852417,  0.956481934,  0.935195923,  0.913055420, 0.890090942,  0.866363525,  0.841949463,  0.816864014,
 0.791213989,  0.765029907,  0.738372803,  0.711318970, 0.683914185,  0.656219482,  0.628295898,  0.600219727,
 0.572036743,  0.543823242,  0.515609741,  0.487472534, 0.459472656,  0.431655884,  0.404083252,  0.376800537,
 0.349868774,  0.323318481,  0.297210693,  0.271591187, 0.246505737,  0.221984863,  0.198059082,  0.174789429,
 0.152206421,  0.130310059,  0.109161377,  0.088775635, 0.069168091,  0.050354004,  0.032379150,  0.015228271,
-0.001068115, -0.016510010, -0.031082153, -0.044784546,-0.057617187, -0.069595337, -0.080688477, -0.090927124,
 0.100311279,  0.108856201,  0.116577148,  0.123474121, 0.129577637,  0.134887695,  0.139450073,  0.143264771,
 0.146362305,  0.148773193,  0.150497437,  0.151596069, 0.152069092,  0.151962280,  0.151306152,  0.150115967,
 0.148422241,  0.146255493,  0.143676758,  0.140670776, 0.137298584,  0.133590698,  0.129562378,  0.125259399,
 0.120697021,  0.115921021,  0.110946655,  0.105819702, 0.100540161,  0.095169067,  0.089706421,  0.084182739,
 0.078628540,  0.073059082,  0.067520142,  0.061996460, 0.056533813,  0.051132202,  0.045837402,  0.040634155,
 0.035552979,  0.030609131,  0.025817871,  0.021179199, 0.016708374,  0.012420654,  0.008316040,  0.004394531,
 0.000686646, -0.002822876, -0.006134033, -0.009231567,-0.012115479, -0.014801025, -0.017257690, -0.019531250,
-0.021575928, -0.023422241, -0.025085449, -0.026535034,-0.027801514, -0.028884888, -0.029785156, -0.030517578,
 0.031082153,  0.031478882,  0.031738281,  0.031845093, 0.031814575,  0.031661987,  0.031387329,  0.031005859,
 0.030532837,  0.029937744,  0.029281616,  0.028533936, 0.027725220,  0.026840210,  0.025909424,  0.024932861,
 0.023910522,  0.022857666,  0.021789551,  0.020690918, 0.019577026,  0.018463135,  0.017349243,  0.016235352,
 0.015121460,  0.014022827,  0.012939453,  0.011886597, 0.010848999,  0.009841919,  0.008865356,  0.007919312,
 0.007003784,  0.006118774,  0.005294800,  0.004486084, 0.003723145,  0.003005981,  0.002334595,  0.001693726,
 0.001098633,  0.000549316,  0.000030518, -0.000442505,-0.000869751, -0.001266479, -0.001617432, -0.001937866,
-0.002227783, -0.002487183, -0.002700806, -0.002883911,-0.003051758, -0.003173828, -0.003280640, -0.003372192,
-0.003417969, -0.003463745, -0.003479004, -0.003479004,-0.003463745, -0.003433228, -0.003387451, -0.003326416,
 0.003250122,  0.003173828,  0.003082275,  0.002990723, 0.002899170,  0.002792358,  0.002685547,  0.002578735,
 0.002456665,  0.002349854,  0.002243042,  0.002120972, 0.002014160,  0.001907349,  0.001785278,  0.001693726,
 0.001586914,  0.001480103,  0.001388550,  0.001296997, 0.001205444,  0.001113892,  0.001037598,  0.000961304,
 0.000885010,  0.000808716,  0.000747681,  0.000686646, 0.000625610,  0.000579834,  0.000534058,  0.000473022,
 0.000442505,  0.000396729,  0.000366211,  0.000320435, 0.000289917,  0.000259399,  0.000244141,  0.000213623,
 0.000198364,  0.000167847,  0.000152588,  0.000137329, 0.000122070,  0.000106812,  0.000106812,  0.000091553,
 0.000076294,  0.000076294,  0.000061035,  0.000061035, 0.000045776,  0.000045776,  0.000030518,  0.000030518,
 0.000030518,  0.000030518,  0.000015259,  0.000015259, 0.000015259,  0.000015259,  0.000015259,  0.000015259
};
#endif



IppStatus __STDCALL 
ippsVLCDecodeEscBlock_AAC_1u16s_c(Ipp8u **ppBitStream, int*
										  pBitOffset, Ipp16s *pData, int len, 
										  const IppsVLCDecodeSpec_32s *pVLCSpec)
{
#ifdef KINOMA_VLC
	int x,c=0;
	Ipp16s tmp,tmp1,tmp2;

	unsigned int	bits, currBits; 
	int		i,k,j,m,l;
	int		find;
	int		length;
	k_IppsVLCDecodeSpec_32s *pMyVLCSpec = (k_IppsVLCDecodeSpec_32s *)pVLCSpec;

	if (!ppBitStream || ! pData || ! pVLCSpec)
		return ippStsNullPtrErr;
	if (*pBitOffset < 0 || *pBitOffset > 7)
		return ippStsBitOffsetErr;
	if (pMyVLCSpec->sig != VLC_SIG)
		return ippStsContextMatchErr;

	for (x = 0; x < len/2; x++)
	{
		bits = ((*ppBitStream)[0] << 24) | ((*ppBitStream)[1] << 16) | ((*ppBitStream)[2] <<  8) | ((*ppBitStream)[3]);
		bits <<= *pBitOffset;
		find = 0;

		for (m = 0; m < pMyVLCSpec->numSubTables; m++)
		{
			if (m == 0)
			{
				j = 1;
				l = 0;
			}
			else
			{
				j += pMyVLCSpec->pSubTablesSizes[m-1];
				l = pMyVLCSpec->tablePos[m-1];
			}

			for (k = j; k < j+pMyVLCSpec->pSubTablesSizes[m]; k++)
			{
				currBits = bits >> (32 - k);
				for (i = l; i < pMyVLCSpec->tablePos[m]; i++)
				{
					if(currBits == pMyVLCSpec->pNewTable[i].code && k == pMyVLCSpec->pNewTable[i].length)
					{
						// found it
						length = k;
						tmp = pMyVLCSpec->pNewTable[i].value;
						find =1;
						break;
					}
				}
				if(find)
					break;
			}
			if(find)
				break;
		}

		if (!find)
			return ippStsVLCInputDataErr;

		length = length + *pBitOffset;
		*ppBitStream += length >> 3;
		*pBitOffset = length & 7;

		/* esc */
		tmp1 = tmp >> 8;
		tmp2 = tmp - 256 * tmp1 - 128;

		if (abs(tmp1) == 16)
			pData[c++] = GetAacEsc(tmp1,ppBitStream,pBitOffset);
		else
			pData[c++] = tmp1;

		if (abs(tmp2) == 16)
			pData[c++] = GetAacEsc(tmp2,ppBitStream,pBitOffset);
		else
			pData[c++] = tmp2;
	}

#endif

#ifdef PRINT_REF_INFO
		dump("ippsVLCDecodeEscBlock_AAC_1u16s",-1);
#endif
	
#ifdef INTEL_VLC
	{
		IppStatus sts;
		sts = ippsVLCDecodeEscBlock_AAC_1u16s(ppBitStream, pBitOffset,pData, len, pVLCSpec);
		return sts;
	}
#endif

	return ippStsNoErr;
}



/* following functions only used in mp3*/
IppStatus __STDCALL 
ippsVLCDecodeEscBlock_MP3_1u16s_c(Ipp8u **ppBitStream,
                                int *pBitOffset,
                                int linbits,
                                Ipp16s *pData,
                                int len,
                                const IppsVLCDecodeSpec_32s *pVLCSpec)
{
#ifdef KINOMA_VLC
	int x,c=0, needEsc;
	Ipp16s tmp,tmp1,tmp2;

	unsigned int	bits, currBits; 
	int		i,k,j,m,l;
	int		find;
	int		length;
	k_IppsVLCDecodeSpec_32s *pMyVLCSpec = (k_IppsVLCDecodeSpec_32s *)pVLCSpec;

	if (!ppBitStream || ! pData || ! pVLCSpec)
		return ippStsNullPtrErr;
	if (*pBitOffset < 0 || *pBitOffset > 7)
		return ippStsBitOffsetErr;
	if (pMyVLCSpec->sig != VLC_SIG)
		return ippStsContextMatchErr;

	for (x = 0; x < len/2; x++)
	{
		bits = ((*ppBitStream)[0] << 24) | ((*ppBitStream)[1] << 16) | ((*ppBitStream)[2] <<  8) | ((*ppBitStream)[3]);
		bits <<= *pBitOffset;
		find = 0;

		for (m = 0; m < pMyVLCSpec->numSubTables; m++)
		{
			if (m == 0)
			{
				j = 1;
				l = 0;
			}
			else
			{
				j += pMyVLCSpec->pSubTablesSizes[m-1];
				l = pMyVLCSpec->tablePos[m-1];
			}

			for (k = j; k < j+pMyVLCSpec->pSubTablesSizes[m]; k++)
			{
				currBits = bits >> (32 - k);
				for (i = l; i < pMyVLCSpec->tablePos[m]; i++)
				{
					if(currBits == pMyVLCSpec->pNewTable[i].code && k == pMyVLCSpec->pNewTable[i].length)
					{
						// found it
						length = k;
						tmp = pMyVLCSpec->pNewTable[i].value;
						find =1;
						break;
					}
				}
				if(find)
					break;
			}
			if(find)
				break;
		}

		if (!find)
			return ippStsVLCInputDataErr;

		length = length + *pBitOffset;
		*ppBitStream += length >> 3;
		*pBitOffset = length & 7;

		/* esc */
		tmp1 = tmp >> 8;
		tmp2 = tmp - 256 * tmp1 - 128 ;

		needEsc = 0;	
		/*move the bitOffset backward 1 or 2 bits which the corresponding code value != 0 in ESC mode*/
		if ((abs(tmp1) == 15 || abs(tmp2) == 15) && (abs(tmp1) + abs(tmp2) > 15))
		{
			*pBitOffset = *pBitOffset - 2;
			if (*pBitOffset < 0)
			{
				*pBitOffset += 8;
				(*ppBitStream)--;
			}
			needEsc = 1;
		}
		else if ((abs(tmp1) == 15 || abs(tmp2) == 15) && (abs(tmp1) + abs(tmp2) == 15))
		{
			*pBitOffset = *pBitOffset - 1;
			if (*pBitOffset < 0)
			{
				*pBitOffset = 7;
				(*ppBitStream)--;
			}
			needEsc = 1;
		}

		if (!needEsc)
		{
			pData[c++] = tmp1;
			pData[c++] = tmp2;
		}
		else
		{
			if (abs(tmp1) == 15)
				tmp1 = GetMp3Esc(ppBitStream,pBitOffset,linbits);

			if (tmp1 != 0)
				pData[c++] = abs(tmp1) * SignMp3Esc(ppBitStream,pBitOffset);
			else 
				pData[c++] = 0;


			if (abs(tmp2) == 15)
				tmp2 = GetMp3Esc(ppBitStream,pBitOffset,linbits);

			if (tmp2 != 0)
				pData[c++] = abs(tmp2) * SignMp3Esc(ppBitStream,pBitOffset);
			else 
				pData[c++] = 0;
		}

	}
#endif

#ifdef PRINT_REF_INFO
	dump("ippsVLCDecodeEscBlock_MP3_1u16s",-1);
#endif

#ifdef INTEL_VLC
	{
		IppStatus sts;
		sts = ippsVLCDecodeEscBlock_MP3_1u16s(ppBitStream,pBitOffset,linbits,pData,len,pVLCSpec);
		return sts;
	}
#endif
	return ippStsNoErr;
}



IppStatus __STDCALL 
ippsSynthPQMF_MP3_32s16s_c(Ipp32s* pSrcY, Ipp16s* pDstAudioOut, Ipp32s*
						 pVBuffer, int* pVPosition, int mode)
{
#ifdef KINOMA_SYNTH
	int i, j,k,tmp; 
	register double sum, *pFilter;

	//the pVBuffer is a 512/channel buffer, but in 11172-3 spec, the algorithm need 1024/channel,
	//I don't know what algorithm intel use 512/channel to implement this function, so I have to declare two 1024
	//static buffer for my implementation.
	static double VBuf1[1024],VBuf2[1024];		
	static int pchan;
	static int pos1, pos2;
	static int init = 1;
	double *pVBufTmp,  *pVBuf;
	double src[32];
	int chan, pos;

	if (!pSrcY || !pDstAudioOut || !pVBuffer || !pVPosition)
		return ippStsNullPtrErr;

	if ((mode < 1 || mode > 2) || (*pVPosition < 0 || *pVPosition > 15))
		return ippStsBadArgErr;
	
	if (init)
	{
		memset(VBuf1,0,1024*sizeof(double));
		memset(VBuf2,0,1024*sizeof(double));
		init = 0;
		pchan = pVBuffer;
		pos1 = 0;
		pos2 = 0;

		chan = 1;
		pos = 0;
	}
	if (pchan == pVBuffer)
	{
		chan = 1;
		pVBufTmp = VBuf1;
		pos = pos1;
	}
	else
	{
		chan = 2;
		pVBufTmp = VBuf2;
		pos = pos2;
	}

	QF2DP(pSrcY, src,7,24,32);
	pVBuf = pVBufTmp + pos;

	/* fast 32 IMDCT in synthPQMF*/
	pFilter = fastFilter;
	for (i = 0; i < 16; i++)
	{
		sum = 0;
		for (j = 0; j < 32; j++)
		{
			sum += pFilter[j] * src[j];

		}
		pVBuf[i] = sum;
		pVBuf[32-i] = -sum;
		pFilter += 32;
	}
	pVBuf[16] = 0;
	for (i = 33; i < 48; i++)
	{
		sum = 0;
		for (j = 0; j < 32; j++)
		{
			sum += pFilter[j] * src[j];
		}
		pVBuf[96-i] = pVBuf[i] = sum;
		pFilter += 32;
	}
	sum = 0;
	for (i = 0; i < 32; i++)
	{
		sum += src[i];
	}
	pVBuf[48] = -sum;
	/* fast IMDCT end */

	pVBuf = pVBufTmp;


	/* following is the merged processing of two steps discribed in spec.*/
    for (j=0; j<32; j++) 
	{
        sum = 0;
        for (i=0; i<16; i++) 
		{
            k = j + (i<<5);
            sum += window[k] * pVBuf[(k + (((i+1)>>1)<<6) + pos) & 0x3ff];
        }
		tmp = (int)(sum * 32768); // here round to zero, 
		pDstAudioOut[j*mode] = (Ipp16s)CLIP(tmp,MAX_16S,MIN_16S);
	}

	//	update the position of Vbuffer pointer
	if (chan ==1)
		pos1 = (pos1 - 64) & 0x3ff;
	else
		pos2 = (pos2 - 64) & 0x3ff;
	//	
	
#endif

#ifdef PRINT_REF_INFO
	dump("ippsSynthPQMF_MP3_32s16s",-1);
#endif

#ifdef INTEL_SYNTH
	{
		IppStatus sts;
		sts = ippsSynthPQMF_MP3_32s16s(pSrcY, pDstAudioOut, pVBuffer, pVPosition, mode);
		return sts;
	}
#endif

	return ippStsNoErr;
}

#endif
