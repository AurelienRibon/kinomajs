/*
     Copyright (C) 2010-2015 Marvell International Ltd.
     Copyright (C) 2002-2010 Kinoma, Inc.

     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License.
*/
#include "stdio.h"
#include "stdlib.h"
#include <string.h>
#include <stdarg.h>

/*
//keep the code here in case we want to fix the font 
long fontLong[1248] =
{
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00100000, 0x01010000, 0x00000000, 0x00100000, 0x01001000, 0x00000000, 0x00100000,
	0x00000000, 0x00100000, 0x01010000, 0x01010000, 0x01111000, 0x10101000, 0x01000000, 0x00100000,
	0x00000000, 0x00100000, 0x01010000, 0x01010000, 0x10100000, 0x01010000, 0x10100000, 0x00100000,
	0x00000000, 0x00100000, 0x00000000, 0x11111000, 0x10100000, 0x00010000, 0x10100000, 0x00000000,
	0x00000000, 0x00100000, 0x00000000, 0x01010000, 0x01110000, 0x00100000, 0x01000000, 0x00000000,
	0x00000000, 0x00100000, 0x00000000, 0x11111000, 0x00101000, 0x01000000, 0x10100000, 0x00000000,
	0x00000000, 0x00100000, 0x00000000, 0x01010000, 0x00101000, 0x01010000, 0x10011000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x01010000, 0x11110000, 0x10101000, 0x10010000, 0x00000000,
	0x00000000, 0x00100000, 0x00000000, 0x00000000, 0x00100000, 0x10010000, 0x01101000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00010000, 0x01000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00001000,
	0x00100000, 0x00100000, 0x10101000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00001000,
	0x01000000, 0x00010000, 0x01110000, 0x00100000, 0x00000000, 0x00000000, 0x00000000, 0x00010000,
	0x01000000, 0x00010000, 0x10101000, 0x00100000, 0x00000000, 0x00000000, 0x00000000, 0x00010000,
	0x01000000, 0x00010000, 0x00100000, 0x11111000, 0x00000000, 0x11111000, 0x00000000, 0x00100000,
	0x01000000, 0x00010000, 0x00000000, 0x00100000, 0x00000000, 0x00000000, 0x00000000, 0x01000000,
	0x01000000, 0x00010000, 0x00000000, 0x00100000, 0x00000000, 0x00000000, 0x00000000, 0x01000000,
	0x00100000, 0x00100000, 0x00000000, 0x00000000, 0x00110000, 0x00000000, 0x00100000, 0x10000000,
	0x00100000, 0x00100000, 0x00000000, 0x00000000, 0x00100000, 0x00000000, 0x01110000, 0x10000000,
	0x00010000, 0x01000000, 0x00000000, 0x00000000, 0x01000000, 0x00000000, 0x00100000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00100000, 0x00100000, 0x01110000, 0x11111000, 0x00010000, 0x11111000, 0x01110000, 0x11111000,
	0x01010000, 0x01100000, 0x10001000, 0x00001000, 0x00010000, 0x10000000, 0x10001000, 0x00001000,
	0x10001000, 0x10100000, 0x10001000, 0x00010000, 0x00110000, 0x10000000, 0x10000000, 0x00010000,
	0x10001000, 0x00100000, 0x00001000, 0x00100000, 0x01010000, 0x10110000, 0x10000000, 0x00010000,
	0x10001000, 0x00100000, 0x00010000, 0x01110000, 0x01010000, 0x11001000, 0x11110000, 0x00100000,
	0x10001000, 0x00100000, 0x00100000, 0x00001000, 0x10010000, 0x00001000, 0x10001000, 0x00100000,
	0x10001000, 0x00100000, 0x01000000, 0x00001000, 0x11111000, 0x00001000, 0x10001000, 0x01000000,
	0x01010000, 0x00100000, 0x10000000, 0x10001000, 0x00010000, 0x10001000, 0x10001000, 0x01000000,
	0x00100000, 0x11111000, 0x11111000, 0x01110000, 0x00010000, 0x01110000, 0x01110000, 0x01000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x01110000, 0x01110000, 0x00000000, 0x00000000, 0x00001000, 0x00000000, 0x10000000, 0x01110000,
	0x10001000, 0x10001000, 0x00000000, 0x00000000, 0x00010000, 0x00000000, 0x01000000, 0x10001000,
	0x10001000, 0x10001000, 0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00100000, 0x10001000,
	0x10001000, 0x10001000, 0x01110000, 0x01110000, 0x01000000, 0x11111000, 0x00010000, 0x00001000,
	0x01110000, 0x01111000, 0x00100000, 0x00100000, 0x10000000, 0x00000000, 0x00001000, 0x00010000,
	0x10001000, 0x00001000, 0x00000000, 0x00000000, 0x01000000, 0x00000000, 0x00010000, 0x00100000,
	0x10001000, 0x00001000, 0x00000000, 0x00000000, 0x00100000, 0x11111000, 0x00100000, 0x00100000,
	0x10001000, 0x10001000, 0x00100000, 0x00110000, 0x00010000, 0x00000000, 0x01000000, 0x00000000,
	0x01110000, 0x01110000, 0x01110000, 0x00100000, 0x00001000, 0x00000000, 0x10000000, 0x00100000,
	0x00000000, 0x00000000, 0x00100000, 0x01000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x01110000, 0x00100000, 0x11110000, 0x01110000, 0x11110000, 0x11111000, 0x11111000, 0x01110000,
	0x10001000, 0x01010000, 0x01001000, 0x10001000, 0x01001000, 0x10000000, 0x10000000, 0x10001000,
	0x10001000, 0x10001000, 0x01001000, 0x10000000, 0x01001000, 0x10000000, 0x10000000, 0x10000000,
	0x10011000, 0x10001000, 0x01001000, 0x10000000, 0x01001000, 0x10000000, 0x10000000, 0x10000000,
	0x10101000, 0x10001000, 0x01110000, 0x10000000, 0x01001000, 0x11110000, 0x11110000, 0x10000000,
	0x10101000, 0x11111000, 0x01001000, 0x10000000, 0x01001000, 0x10000000, 0x10000000, 0x10011000,
	0x10110000, 0x10001000, 0x01001000, 0x10000000, 0x01001000, 0x10000000, 0x10000000, 0x10001000,
	0x10000000, 0x10001000, 0x01001000, 0x10001000, 0x01001000, 0x10000000, 0x10000000, 0x10001000,
	0x01111000, 0x10001000, 0x11110000, 0x01110000, 0x11110000, 0x11111000, 0x10000000, 0x01110000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x10001000, 0x01110000, 0x00111000, 0x10001000, 0x10000000, 0x10001000, 0x10001000, 0x01110000,
	0x10001000, 0x00100000, 0x00010000, 0x10001000, 0x10000000, 0x10001000, 0x11001000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x10010000, 0x10000000, 0x11011000, 0x11001000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x10100000, 0x10000000, 0x10101000, 0x10101000, 0x10001000,
	0x11111000, 0x00100000, 0x00010000, 0x11000000, 0x10000000, 0x10101000, 0x10101000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x10100000, 0x10000000, 0x10001000, 0x10011000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x10010000, 0x10000000, 0x10001000, 0x10011000, 0x10001000,
	0x10001000, 0x00100000, 0x10010000, 0x10001000, 0x10000000, 0x10001000, 0x10001000, 0x10001000,
	0x10001000, 0x01110000, 0x01100000, 0x10001000, 0x11111000, 0x10001000, 0x10001000, 0x01110000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x11110000, 0x01110000, 0x11110000, 0x01110000, 0x11111000, 0x10001000, 0x10001000, 0x10001000,
	0x10001000, 0x10001000, 0x10001000, 0x10001000, 0x00100000, 0x10001000, 0x10001000, 0x10001000,
	0x10001000, 0x10001000, 0x10001000, 0x10000000, 0x00100000, 0x10001000, 0x10001000, 0x10001000,
	0x10001000, 0x10001000, 0x10001000, 0x10000000, 0x00100000, 0x10001000, 0x10001000, 0x10001000,
	0x11110000, 0x10001000, 0x11110000, 0x01110000, 0x00100000, 0x10001000, 0x01010000, 0x10101000,
	0x10000000, 0x10001000, 0x10100000, 0x00001000, 0x00100000, 0x10001000, 0x01010000, 0x10101000,
	0x10000000, 0x10001000, 0x10010000, 0x00001000, 0x00100000, 0x10001000, 0x01010000, 0x10101000,
	0x10000000, 0x10101000, 0x10001000, 0x10001000, 0x00100000, 0x10001000, 0x00100000, 0x10101000,
	0x10000000, 0x01110000, 0x10001000, 0x01110000, 0x00100000, 0x01110000, 0x00100000, 0x01010000,
	0x00000000, 0x00001000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x01110000, 0x00000000, 0x01110000, 0x00000000, 0x00000000,
	0x10001000, 0x10001000, 0x11111000, 0x01000000, 0x10000000, 0x00010000, 0x00100000, 0x00000000,
	0x10001000, 0x10001000, 0x00001000, 0x01000000, 0x10000000, 0x00010000, 0x01010000, 0x00000000,
	0x01010000, 0x01010000, 0x00010000, 0x01000000, 0x01000000, 0x00010000, 0x10001000, 0x00000000,
	0x01010000, 0x01010000, 0x00010000, 0x01000000, 0x01000000, 0x00010000, 0x00000000, 0x00000000,
	0x00100000, 0x00100000, 0x00100000, 0x01000000, 0x00100000, 0x00010000, 0x00000000, 0x00000000,
	0x01010000, 0x00100000, 0x01000000, 0x01000000, 0x00010000, 0x00010000, 0x00000000, 0x00000000,
	0x01010000, 0x00100000, 0x01000000, 0x01000000, 0x00010000, 0x00010000, 0x00000000, 0x00000000,
	0x10001000, 0x00100000, 0x10000000, 0x01000000, 0x00001000, 0x00010000, 0x00000000, 0x00000000,
	0x10001000, 0x00100000, 0x11111000, 0x01000000, 0x00001000, 0x00010000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x01110000, 0x00000000, 0x01110000, 0x00000000, 0x11111000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00100000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00010000, 0x00000000, 0x10000000, 0x00000000, 0x00001000, 0x00000000, 0x00110000, 0x00000000,
	0x00000000, 0x00000000, 0x10000000, 0x00000000, 0x00001000, 0x00000000, 0x01001000, 0x00000000,
	0x00000000, 0x00000000, 0x10000000, 0x00000000, 0x00001000, 0x00000000, 0x01000000, 0x00000000,
	0x00000000, 0x01110000, 0x11110000, 0x01110000, 0x01111000, 0x01110000, 0x01000000, 0x01110000,
	0x00000000, 0x00001000, 0x10001000, 0x10001000, 0x10001000, 0x10001000, 0x11110000, 0x10001000,
	0x00000000, 0x01111000, 0x10001000, 0x10000000, 0x10001000, 0x11111000, 0x01000000, 0x10001000,
	0x00000000, 0x10001000, 0x10001000, 0x10000000, 0x10001000, 0x10000000, 0x01000000, 0x10001000,
	0x00000000, 0x10011000, 0x10001000, 0x10001000, 0x10001000, 0x10001000, 0x01000000, 0x01111000,
	0x00000000, 0x01101000, 0x11110000, 0x01110000, 0x01111000, 0x01110000, 0x01000000, 0x00001000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x10001000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x01110000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x10000000, 0x00000000, 0x00000000, 0x10000000, 0x01100000, 0x00000000, 0x00000000, 0x00000000,
	0x10000000, 0x00100000, 0x00010000, 0x10000000, 0x00100000, 0x00000000, 0x00000000, 0x00000000,
	0x10000000, 0x00000000, 0x00000000, 0x10000000, 0x00100000, 0x00000000, 0x00000000, 0x00000000,
	0x10110000, 0x01100000, 0x00110000, 0x10010000, 0x00100000, 0x11010000, 0x10110000, 0x01110000,
	0x11001000, 0x00100000, 0x00010000, 0x10100000, 0x00100000, 0x10101000, 0x11001000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x11000000, 0x00100000, 0x10101000, 0x10001000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x10100000, 0x00100000, 0x10101000, 0x10001000, 0x10001000,
	0x10001000, 0x00100000, 0x00010000, 0x10010000, 0x00100000, 0x10101000, 0x10001000, 0x10001000,
	0x10001000, 0x01110000, 0x10010000, 0x10001000, 0x01110000, 0x10001000, 0x10001000, 0x01110000,
	0x00000000, 0x00000000, 0x10010000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x01100000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x01000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x01000000, 0x00000000, 0x00000000, 0x00000000,
	0x11110000, 0x01111000, 0x10110000, 0x01110000, 0x11110000, 0x10001000, 0x10001000, 0x10001000,
	0x10001000, 0x10001000, 0x11001000, 0x10001000, 0x01000000, 0x10001000, 0x10001000, 0x10001000,
	0x10001000, 0x10001000, 0x10000000, 0x01100000, 0x01000000, 0x10001000, 0x10001000, 0x10101000,
	0x10001000, 0x10001000, 0x10000000, 0x00010000, 0x01000000, 0x10001000, 0x01010000, 0x10101000,
	0x11110000, 0x01111000, 0x10000000, 0x10001000, 0x01001000, 0x10011000, 0x01010000, 0x10101000,
	0x10000000, 0x00001000, 0x10000000, 0x01110000, 0x00110000, 0x01101000, 0x00100000, 0x01010000,
	0x10000000, 0x00001000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x10000000, 0x00001000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	
	0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00011000, 0x00000000, 0x11000000, 0x00000000, 0x00000000,
	0x00000000, 0x00000000, 0x00000000, 0x00100000, 0x00100000, 0x00100000, 0x01001000, 0x01110000,
	0x00000000, 0x00000000, 0x00000000, 0x00100000, 0x00100000, 0x00100000, 0x10101000, 0x10001000,
	0x00000000, 0x00000000, 0x00000000, 0x00100000, 0x00100000, 0x00100000, 0x10010000, 0x10001000,
	0x10001000, 0x10001000, 0x11111000, 0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00001000,
	0x01010000, 0x10001000, 0x00010000, 0x11000000, 0x00100000, 0x00011000, 0x00000000, 0x00010000,
	0x00100000, 0x10001000, 0x00100000, 0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00100000,
	0x00100000, 0x10011000, 0x01000000, 0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00100000,
	0x01010000, 0x01101000, 0x10000000, 0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00000000,
	0x10001000, 0x00001000, 0x11111000, 0x00100000, 0x00100000, 0x00100000, 0x00000000, 0x00100000,
	0x00000000, 0x10001000, 0x00000000, 0x00011000, 0x00000000, 0x11000000, 0x00000000, 0x00000000,
	0x00000000, 0x01110000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000
};

#define kFontGroupWidth		8
#define kFontGroupHeight	13

void CreateFont()
{
	int i, j, k;
	
	for( i = 0; i < kFontGroupHeight; i++ )
	{
		for( j = 0; j < kFontGroupWidth; j++ )
		{
			long	line0 = i * kFontGroupWidth * kFontGroupHeight + j;
			
			for( k = 0; k < 13; k++ )
			{
				long	line1 = line0 + k * kFontGroupWidth;
				long	value = fontLong[line1];
				long	v0, v1, v2, v3, v4, v5, v6, v7;
				unsigned char out;
				
				v7 = ( value&0x10000000 ) != 0;
				v6 = ( value&0x01000000 ) != 0;
				v5 = ( value&0x00100000 ) != 0;
				v4 = ( value&0x00010000 ) != 0;
				v3 = ( value&0x00001000 ) != 0;
				v2 = ( value&0x00000100 ) != 0;
				v1 = ( value&0x00000010 ) != 0;
				v0 = ( value&0x00000001 ) != 0;
				
				out = (v0<<0)|(v1<<1)|(v2<<2)|(v3<<3)|(v4<<4)|(v5<<5)|(v6<<6)|(v7<<7);
				printf( "%4d,", out );
			}
			printf( "\n" );
		}
		printf( "\n" );
	}	
	exit(0);
}
*/

#define kFontDisplayWidth	6
#define kFontWidth			5
#define kFontHeight			14
#define kFontTotal			96
#define kHiLightValue		255
#define	kShadowValue		96

void buf_printf(int is_interleaved, unsigned char* yPtr, int rowbytes, int height, int x, int y, const char* fmt, ...)
{
	unsigned  char font[kFontTotal*kFontHeight] =
	{
	   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
	   0,   0,  32,  32,  32,  32,  32,  32,  32,   0,  32,   0,   0,   0,
	   0,   0,  80,  80,  80,   0,   0,   0,   0,   0,   0,   0,   0,   0,
	   0,   0,   0,  80,  80, 248,  80, 248,  80,  80,   0,   0,   0,   0,
	   0,   0,  32, 120, 160, 160, 112,  40,  40, 240,  32,   0,   0,   0,
	   0,   0,  72, 168,  80,  16,  32,  64,  80, 168, 144,   0,   0,   0,
	   0,   0,   0,  64, 160, 160,  64, 160, 152, 144, 104,   0,   0,   0,
	   0,   0,  32,  32,  32,   0,   0,   0,   0,   0,   0,   0,   0,   0,
																	 
	   0,  16,  32,  32,  64,  64,  64,  64,  64,  32,  32,  16,   0,   0,
	   0,  64,  32,  32,  16,  16,  16,  16,  16,  32,  32,  64,   0,   0,
	   0,   0,  32, 168, 112, 168,  32,   0,   0,   0,   0,   0,   0,   0,
	   0,   0,   0,   0,  32,  32, 248,  32,  32,   0,   0,   0,   0,   0,
	   0,   0,   0,   0,   0,   0,   0,   0,   0,  48,  32,  64,   0,   0,
	   0,   0,   0,   0,   0,   0, 248,   0,   0,   0,   0,   0,   0,   0,
	   0,   0,   0,   0,   0,   0,   0,   0,   0,  32, 112,  32,   0,   0,
	   0,   0,   8,   8,  16,  16,  32,  64,  64, 128, 128,   0,   0,   0,
																	 
	   0,   0,  32,  80, 136, 136, 136, 136, 136,  80,  32,   0,   0,   0,
	   0,   0,  32,  96, 160,  32,  32,  32,  32,  32, 248,   0,   0,   0,
	   0,   0, 112, 136, 136,   8,  16,  32,  64, 128, 248,   0,   0,   0,
	   0,   0, 248,   8,  16,  32, 112,   8,   8, 136, 112,   0,   0,   0,
	   0,   0,  16,  16,  48,  80,  80, 144, 248,  16,  16,   0,   0,   0,
	   0,   0, 248, 128, 128, 176, 200,   8,   8, 136, 112,   0,   0,   0,
	   0,   0, 112, 136, 128, 128, 240, 136, 136, 136, 112,   0,   0,   0,
	   0,   0, 248,   8,  16,  16,  32,  32,  64,  64,  64,   0,   0,   0,
																	 
	   0,   0, 112, 136, 136, 136, 112, 136, 136, 136, 112,   0,   0,   0,
	   0,   0, 112, 136, 136, 136, 120,   8,   8, 136, 112,   0,   0,   0,
	   0,   0,   0,   0,  32, 112,  32,   0,   0,  32, 112,  32,   0,   0,
	   0,   0,   0,   0,  32, 112,  32,   0,   0,  48,  32,  64,   0,   0,
	   0,   0,   8,  16,  32,  64, 128,  64,  32,  16,   8,   0,   0,   0,
	   0,   0,   0,   0,   0, 248,   0,   0, 248,   0,   0,   0,   0,   0,
	   0,   0, 128,  64,  32,  16,   8,  16,  32,  64, 128,   0,   0,   0,
	   0,   0, 112, 136, 136,   8,  16,  32,  32,   0,  32,   0,   0,   0,
																	 
	   0,   0, 112, 136, 136, 152, 168, 168, 176, 128, 120,   0,   0,   0,
	   0,   0,  32,  80, 136, 136, 136, 248, 136, 136, 136,   0,   0,   0,
	   0,   0, 240,  72,  72,  72, 112,  72,  72,  72, 240,   0,   0,   0,
	   0,   0, 112, 136, 128, 128, 128, 128, 128, 136, 112,   0,   0,   0,
	   0,   0, 240,  72,  72,  72,  72,  72,  72,  72, 240,   0,   0,   0,
	   0,   0, 248, 128, 128, 128, 240, 128, 128, 128, 248,   0,   0,   0,
	   0,   0, 248, 128, 128, 128, 240, 128, 128, 128, 128,   0,   0,   0,
	   0,   0, 112, 136, 128, 128, 128, 152, 136, 136, 112,   0,   0,   0,
																	 
	   0,   0, 136, 136, 136, 136, 248, 136, 136, 136, 136,   0,   0,   0,
	   0,   0, 112,  32,  32,  32,  32,  32,  32,  32, 112,   0,   0,   0,
	   0,   0,  56,  16,  16,  16,  16,  16,  16, 144,  96,   0,   0,   0,
	   0,   0, 136, 136, 144, 160, 192, 160, 144, 136, 136,   0,   0,   0,
	   0,   0, 128, 128, 128, 128, 128, 128, 128, 128, 248,   0,   0,   0,
	   0,   0, 136, 136, 216, 168, 168, 136, 136, 136, 136,   0,   0,   0,
	   0,   0, 136, 200, 200, 168, 168, 152, 152, 136, 136,   0,   0,   0,
	   0,   0, 112, 136, 136, 136, 136, 136, 136, 136, 112,   0,   0,   0,
																	 
	   0,   0, 240, 136, 136, 136, 240, 128, 128, 128, 128,   0,   0,   0,
	   0,   0, 112, 136, 136, 136, 136, 136, 136, 168, 112,   8,   0,   0,
	   0,   0, 240, 136, 136, 136, 240, 160, 144, 136, 136,   0,   0,   0,
	   0,   0, 112, 136, 128, 128, 112,   8,   8, 136, 112,   0,   0,   0,
	   0,   0, 248,  32,  32,  32,  32,  32,  32,  32,  32,   0,   0,   0,
	   0,   0, 136, 136, 136, 136, 136, 136, 136, 136, 112,   0,   0,   0,
	   0,   0, 136, 136, 136, 136,  80,  80,  80,  32,  32,   0,   0,   0,
	   0,   0, 136, 136, 136, 136, 168, 168, 168, 168,  80,   0,   0,   0,
																	 
	   0,   0, 136, 136,  80,  80,  32,  80,  80, 136, 136,   0,   0,   0,
	   0,   0, 136, 136,  80,  80,  32,  32,  32,  32,  32,   0,   0,   0,
	   0,   0, 248,   8,  16,  16,  32,  64,  64, 128, 248,   0,   0,   0,
	   0, 112,  64,  64,  64,  64,  64,  64,  64,  64,  64, 112,   0,   0,
	   0,   0, 128, 128,  64,  64,  32,  16,  16,   8,   8,   0,   0,   0,
	   0, 112,  16,  16,  16,  16,  16,  16,  16,  16,  16, 112,   0,   0,
	   0,   0,  32,  80, 136,   0,   0,   0,   0,   0,   0,   0,   0,   0,
	   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 248,   0,   0,
																	 
	   0,  32,  16,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
	   0,   0,   0,   0,   0, 112,   8, 120, 136, 152, 104,   0,   0,   0,
	   0,   0, 128, 128, 128, 240, 136, 136, 136, 136, 240,   0,   0,   0,
	   0,   0,   0,   0,   0, 112, 136, 128, 128, 136, 112,   0,   0,   0,
	   0,   0,   8,   8,   8, 120, 136, 136, 136, 136, 120,   0,   0,   0,
	   0,   0,   0,   0,   0, 112, 136, 248, 128, 136, 112,   0,   0,   0,
	   0,   0,  48,  72,  64,  64, 240,  64,  64,  64,  64,   0,   0,   0,
	   0,   0,   0,   0,   0, 112, 136, 136, 136, 120,   8, 136, 112,   0,
																	 
	   0,   0, 128, 128, 128, 176, 200, 136, 136, 136, 136,   0,   0,   0,
	   0,   0,   0,  32,   0,  96,  32,  32,  32,  32, 112,   0,   0,   0,
	   0,   0,   0,  16,   0,  48,  16,  16,  16,  16, 144, 144,  96,   0,
	   0,   0, 128, 128, 128, 144, 160, 192, 160, 144, 136,   0,   0,   0,
	   0,   0,  96,  32,  32,  32,  32,  32,  32,  32, 112,   0,   0,   0,
	   0,   0,   0,   0,   0, 208, 168, 168, 168, 168, 136,   0,   0,   0,
	   0,   0,   0,   0,   0, 176, 200, 136, 136, 136, 136,   0,   0,   0,
	   0,   0,   0,   0,   0, 112, 136, 136, 136, 136, 112,   0,   0,   0,
																	 
	   0,   0,   0,   0,   0, 240, 136, 136, 136, 240, 128, 128, 128,   0,
	   0,   0,   0,   0,   0, 120, 136, 136, 136, 120,   8,   8,   8,   0,
	   0,   0,   0,   0,   0, 176, 200, 128, 128, 128, 128,   0,   0,   0,
	   0,   0,   0,   0,   0, 112, 136,  96,  16, 136, 112,   0,   0,   0,
	   0,   0,   0,  64,  64, 240,  64,  64,  64,  72,  48,   0,   0,   0,
	   0,   0,   0,   0,   0, 136, 136, 136, 136, 152, 104,   0,   0,   0,
	   0,   0,   0,   0,   0, 136, 136, 136,  80,  80,  32,   0,   0,   0,
	   0,   0,   0,   0,   0, 136, 136, 168, 168, 168,  80,   0,   0,   0,
																	 
	   0,   0,   0,   0,   0, 136,  80,  32,  32,  80, 136,   0,   0,   0,
	   0,   0,   0,   0,   0, 136, 136, 136, 152, 104,   8, 136, 112,   0,
	   0,   0,   0,   0,   0, 248,  16,  32,  64, 128, 248,   0,   0,   0,
	   0,  24,  32,  32,  32,  32, 192,  32,  32,  32,  32,  24,   0,   0,
	   0,   0,  32,  32,  32,  32,  32,  32,  32,  32,  32,   0,   0,   0,
	   0, 192,  32,  32,  32,  32,  24,  32,  32,  32,  32, 192,   0,   0,
	   0,   0,  72, 168, 144,   0,   0,   0,   0,   0,   0,   0,   0,   0,
	   0,   0, 112, 136, 136,   8,  16,  32,  32,   0,  32,   0,   0,   0
	};
	char			buf[128];
	int				chCount, chIdx, lineIdx;
	unsigned char	*y0Ptr = yPtr;
	unsigned char	*y1Ptr = y0Ptr + height * rowbytes;
	
#define W_BYTES(x) (is_interleaved ? (x>>1)*6		 : x )
#define	H_BYTES(y) (is_interleaved ? (y>>1)*rowbytes : y * rowbytes ) 

	y1Ptr  = y0Ptr + H_BYTES(height);
	y0Ptr += H_BYTES(y) + W_BYTES(x);

	if( y0Ptr > y1Ptr )  //out of reach
		return;
		
	{
		va_list	ap;
		
		va_start(ap, fmt);
		chCount = vsprintf(buf, fmt, ap);
		va_end(ap);
	}
	
	for( chIdx = 0; chIdx < chCount; chIdx++ )
	{
		unsigned char *draw0Ptr;
		int		      fontIdx; 
		char		  ch = (unsigned char)buf[chIdx];

		draw0Ptr  = y0Ptr + W_BYTES(chIdx * kFontDisplayWidth);

		if( draw0Ptr > y1Ptr - W_BYTES(kFontDisplayWidth) )
			break;
		
		ch -= 0x20;

		if( ch > kFontTotal )
			ch = 0;	         //default space
		
		fontIdx = ch * kFontHeight;
		
		for( lineIdx = 0; lineIdx < kFontHeight; lineIdx += 2 )
		{
			unsigned char *draw1Ptr;
			unsigned char fontLine;
			unsigned char value[2] = { kShadowValue, kHiLightValue };
			int p00,p01,p02,p03,p04,p05;
			int p10,p11,p12,p13,p14,p15;

			fontLine = font[ fontIdx + lineIdx ];
			p00 = value[ (( fontLine & 0x80 ) != 0) ];
			p01 = value[ (( fontLine & 0x40 ) != 0) ];
			p02 = value[ (( fontLine & 0x20 ) != 0) ];
			p03 = value[ (( fontLine & 0x10 ) != 0) ];
			p04 = value[ (( fontLine & 0x08 ) != 0) ];
			p05 = value[0];

			fontLine = font[ fontIdx + (lineIdx+1) ];
			p10 = value[ (( fontLine & 0x80 ) != 0) ];
			p11 = value[ (( fontLine & 0x40 ) != 0) ];
			p12 = value[ (( fontLine & 0x20 ) != 0) ];
			p13 = value[ (( fontLine & 0x10 ) != 0) ];
			p14 = value[ (( fontLine & 0x08 ) != 0) ];
			p15 = value[0];


			if( !is_interleaved )
			{
				draw1Ptr = draw0Ptr + H_BYTES(lineIdx);
				if( draw1Ptr > y1Ptr - W_BYTES(kFontDisplayWidth) )
					break;

				draw1Ptr[0] = p00;
				draw1Ptr[1] = p01;
				draw1Ptr[2] = p02;
				draw1Ptr[3] = p03;
				draw1Ptr[4] = p04;
				draw1Ptr[5] = p05;
			
				draw1Ptr = draw0Ptr + H_BYTES((lineIdx+1));
				if( draw1Ptr > y1Ptr - W_BYTES(kFontDisplayWidth) )
					break;
				
				draw1Ptr[0] = p10;
				draw1Ptr[1] = p11;
				draw1Ptr[2] = p12;
				draw1Ptr[3] = p13;
				draw1Ptr[4] = p14;
				draw1Ptr[5] = p15;
			}
			else
			{
				draw1Ptr = draw0Ptr + H_BYTES(lineIdx);
				if( draw1Ptr > y1Ptr - W_BYTES(kFontDisplayWidth) )
					break;

				draw1Ptr[ 2] = p00;
				draw1Ptr[ 3] = p01;
				draw1Ptr[ 4] = p10;
				draw1Ptr[ 5] = p11;

				draw1Ptr[ 8] = p02;
				draw1Ptr[ 9] = p03;
				draw1Ptr[10] = p12;
				draw1Ptr[11] = p13;

				draw1Ptr[14] = p04;
				draw1Ptr[15] = p05;
				draw1Ptr[16] = p14;
				draw1Ptr[17] = p15;
			}
		}
	}		
}

