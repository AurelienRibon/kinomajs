/*
 *     Copyright (C) 2010-2015 Marvell International Ltd.
 *     Copyright (C) 2002-2010 Kinoma, Inc.
 *
 *     Licensed under the Apache License, Version 2.0 (the "License");
 *     you may not use this file except in compliance with the License.
 *     You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *     Unless required by applicable law or agreed to in writing, software
 *     distributed under the License is distributed on an "AS IS" BASIS,
 *     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *     See the License for the specific language governing permissions and
 *     limitations under the License.
 */
#ifdef BUILT_4_MC
#include "kinoma_ipp_env.h"
#endif

#include "kinoma_ipp_common.h"

IppStatus (__STDCALL *ippsSynthPQMF_MP3_32s16s_universal)		  (Ipp32s* pSrcY, Ipp16s* pDstAudioOut, Ipp32s* pVBuffer, int* pVPosition, int mode) = NULL;

#define KINOMA_SYNTH
//#define INTEL_SYNTH

/* Q24 fixed point format*/
static const int Qfilter[992] = 
{
 11863283, -11863283, -11863283,  11863283,  11863283, -11863283, -11863283,  11863283,
 11863283, -11863283, -11863283,  11863283,  11863283, -11863283, -11863283,  11863283,
 11863283, -11863283, -11863283,  11863283,  11863283, -11863283, -11863283,  11863283,
 11863283, -11863283, -11863283,  11863283,  11863283, -11863283, -11863283,  11863283,
 11266890, -13475586,  -8625213,  15166424,   5652074, -16274424,  -2461729,  16757007,
  -823219, -16595628,   4076531,  15796488,  -7173184, -14390298,   9994176,  12431097,
-12431097,  -9994176,  14390298,   7173184, -15796488,  -4076531,  16595628,    823219,
-16757007,   2461729,  16274424,  -5652074, -15166424,   8625213,  13475586, -11266890,
 10643353, -14796184,  -4870169,  16696429,  -1644455, -16054795,   7908725,  12968963,
-12968963,  -7908725,  16054795,   1644455, -16696429,   4870169,  14796184, -10643353,
-10643353,  14796184,   4870169, -16696429,   1644455,  16054795,  -7908725, -12968963,
 12968963,   7908725, -16054795,  -1644455,  16696429,  -4870169, -14796184,  10643353,
  9994176, -15796488,   -823219,  16274424,  -8625213, -11266890,  15166424,   2461729,
-16595628,   7173184,  12431097, -14390298,  -4076531,  16757007,  -5652074, -13475586,
 13475586,   5652074, -16757007,   4076531,  14390298, -12431097,  -7173184,  16595628,
 -2461729, -15166424,  11266890,   8625213, -16274424,    823219,  15796488,  -9994176,
  9320922, -16454846,   3273072,  13949745, -13949745,  -3273072,  16454846,  -9320922,
 -9320922,  16454846,  -3273072, -13949745,  13949745,   3273072, -16454846,   9320922,
  9320922, -16454846,   3273072,  13949745, -13949745,  -3273072,  16454846,  -9320922,
 -9320922,  16454846,  -3273072, -13949745,  13949745,   3273072, -16454846,   9320922,
  8625213, -16757007,   7173184,   9994176, -16595628,   5652074,  11266890, -16274424,
  4076531,  12431097, -15796488,   2461729,  13475586, -15166424,    823219,  14390298,
-14390298,   -823219,  15166424, -13475586,  -2461729,  15796488, -12431097,  -4076531,
 16274424, -11266890,  -5652074,  16595628,  -9994176,  -7173184,  16757007,  -8625213,
  7908725, -16696429,  10643353,   4870169, -16054795,  12968963,   1644455, -14796184,
 14796184,  -1644455, -12968963,  16054795,  -4870169, -10643353,  16696429,  -7908725,
 -7908725,  16696429, -10643353,  -4870169,  16054795, -12968963,  -1644455,  14796184,
-14796184,   1644455,  12968963, -16054795,   4870169,  10643353, -16696429,   7908725,
  7173184, -16274424,  13475586,   -823219, -12431097,  16595628,  -8625213,  -5652074,
 15796488, -14390298,   2461729,  11266890, -16757007,   9994176,   4076531, -15166424,
 15166424,  -4076531,  -9994176,  16757007, -11266890,  -2461729,  14390298, -15796488,
  5652074,   8625213, -16595628,  12431097,    823219, -13475586,  16274424,  -7173184,
  6420363, -15500126,  15500126,  -6420363,  -6420363,  15500126, -15500126,   6420363,
  6420363, -15500126,  15500126,  -6420363,  -6420363,  15500126, -15500126,   6420363,
  6420363, -15500126,  15500126,  -6420363,  -6420363,  15500126, -15500126,   6420363,
  6420363, -15500126,  15500126,  -6420363,  -6420363,  15500126, -15500126,   6420363,
  5652074, -14390298,  16595628, -11266890,    823219,   9994176, -16274424,  15166424,
 -7173184,  -4076531,  13475586, -16757007,  12431097,  -2461729,  -8625213,  15796488,
-15796488,   8625213,   2461729, -12431097,  16757007, -13475586,   4076531,   7173184,
-15166424,  16274424,  -9994176,   -823219,  11266890, -16595628,  14390298,  -5652074,
  4870169, -12968963,  16696429, -14796184,   7908725,   1644455, -10643353,  16054795,
-16054795,  10643353,  -1644455,  -7908725,  14796184, -16696429,  12968963,  -4870169,
 -4870169,  12968963, -16696429,  14796184,  -7908725,  -1644455,  10643353, -16054795,
 16054795, -10643353,   1644455,   7908725, -14796184,  16696429, -12968963,   4870169,
  4076531, -11266890,  15796488, -16595628,  13475586,  -7173184,   -823219,   8625213,
-14390298,  16757007, -15166424,   9994176,  -2461729,  -5652074,  12431097, -16274424,
 16274424, -12431097,   5652074,   2461729,  -9994176,  15166424, -16757007,  14390298,
 -8625213,    823219,   7173184, -13475586,  16595628, -15796488,  11266890,  -4076531,
  3273072,  -9320922,  13949745, -16454846,  16454846, -13949745,   9320922,  -3273072,
 -3273072,   9320922, -13949745,  16454846, -16454846,  13949745,  -9320922,   3273072,
  3273072,  -9320922,  13949745, -16454846,  16454846, -13949745,   9320922,  -3273072,
 -3273072,   9320922, -13949745,  16454846, -16454846,  13949745,  -9320922,   3273072,
  2461729,  -7173184,  11266890, -14390298,  16274424, -16757007,  15796488, -13475586,
  9994176,  -5652074,    823219,   4076531,  -8625213,  12431097, -15166424,  16595628,
-16595628,  15166424, -12431097,   8625213,  -4076531,   -823219,   5652074,  -9994176,
 13475586, -15796488,  16757007, -16274424,  14390298, -11266890,   7173184,  -2461729,
  1644455,  -4870169,   7908725, -10643353,  12968963, -14796184,  16054795, -16696429,
 16696429, -16054795,  14796184, -12968963,  10643353,  -7908725,   4870169,  -1644455,
 -1644455,   4870169,  -7908725,  10643353, -12968963,  14796184, -16054795,  16696429,
-16696429,  16054795, -14796184,  12968963, -10643353,   7908725,  -4870169,   1644455,
   823219,  -2461729,   4076531,  -5652074,   7173184,  -8625213,   9994176, -11266890,
 12431097, -13475586,  14390298, -15166424,  15796488, -16274424,  16595628, -16757007,
 16757007, -16595628,  16274424, -15796488,  15166424, -14390298,  13475586, -12431097,
 11266890,  -9994176,   8625213,  -7173184,   5652074,  -4076531,   2461729,   -823219,
-12431097,   9994176,  14390298,  -7173184, -15796488,   4076531,  16595628,   -823219,
-16757007,  -2461729,  16274424,   5652074, -15166424,  -8625213,  13475586,  11266890,
-11266890, -13475586,   8625213,  15166424,  -5652074, -16274424,   2461729,  16757007,
   823219, -16595628,  -4076531,  15796488,   7173184, -14390298,  -9994176,  12431097,
-12968963,   7908725,  16054795,  -1644455, -16696429,  -4870169,  14796184,  10643353,
-10643353, -14796184,   4870169,  16696429,   1644455, -16054795,  -7908725,  12968963,
 12968963,  -7908725, -16054795,   1644455,  16696429,   4870169, -14796184, -10643353,
 10643353,  14796184,  -4870169, -16696429,  -1644455,  16054795,   7908725, -12968963,
-13475586,   5652074,  16757007,   4076531, -14390298, -12431097,   7173184,  16595628,
  2461729, -15166424, -11266890,   8625213,  16274424,    823219, -15796488,  -9994176,
  9994176,  15796488,   -823219, -16274424,  -8625213,  11266890,  15166424,  -2461729,
-16595628,  -7173184,  12431097,  14390298,  -4076531, -16757007,  -5652074,  13475586,
-13949745,   3273072,  16454846,   9320922,  -9320922, -16454846,  -3273072,  13949745,
 13949745,  -3273072, -16454846,  -9320922,   9320922,  16454846,   3273072, -13949745,
-13949745,   3273072,  16454846,   9320922,  -9320922, -16454846,  -3273072,  13949745,
 13949745,  -3273072, -16454846,  -9320922,   9320922,  16454846,   3273072, -13949745,
-14390298,    823219,  15166424,  13475586,  -2461729, -15796488, -12431097,   4076531,
 16274424,  11266890,  -5652074, -16595628,  -9994176,   7173184,  16757007,   8625213,
 -8625213, -16757007,  -7173184,   9994176,  16595628,   5652074, -11266890, -16274424,
 -4076531,  12431097,  15796488,   2461729, -13475586, -15166424,   -823219,  14390298,
-14796184,  -1644455,  12968963,  16054795,   4870169, -10643353, -16696429,  -7908725,
  7908725,  16696429,  10643353,  -4870169, -16054795, -12968963,   1644455,  14796184,
 14796184,   1644455, -12968963, -16054795,  -4870169,  10643353,  16696429,   7908725,
 -7908725, -16696429, -10643353,   4870169,  16054795,  12968963,  -1644455, -14796184,
-15166424,  -4076531,   9994176,  16757007,  11266890,  -2461729, -14390298, -15796488,
 -5652074,   8625213,  16595628,  12431097,   -823219, -13475586, -16274424,  -7173184,
  7173184,  16274424,  13475586,    823219, -12431097, -16595628,  -8625213,   5652074,
 15796488,  14390298,   2461729, -11266890, -16757007,  -9994176,   4076531,  15166424,
-15500126,  -6420363,   6420363,  15500126,  15500126,   6420363,  -6420363, -15500126,
-15500126,  -6420363,   6420363,  15500126,  15500126,   6420363,  -6420363, -15500126,
-15500126,  -6420363,   6420363,  15500126,  15500126,   6420363,  -6420363, -15500126,
-15500126,  -6420363,   6420363,  15500126,  15500126,   6420363,  -6420363, -15500126,
-15796488,  -8625213,   2461729,  12431097,  16757007,  13475586,   4076531,  -7173184,
-15166424, -16274424,  -9994176,    823219,  11266890,  16595628,  14390298,   5652074,
 -5652074, -14390298, -16595628, -11266890,   -823219,   9994176,  16274424,  15166424,
  7173184,  -4076531, -13475586, -16757007, -12431097,  -2461729,   8625213,  15796488,
-16054795, -10643353,  -1644455,   7908725,  14796184,  16696429,  12968963,   4870169,
 -4870169, -12968963, -16696429, -14796184,  -7908725,   1644455,  10643353,  16054795,
 16054795,  10643353,   1644455,  -7908725, -14796184, -16696429, -12968963,  -4870169,
  4870169,  12968963,  16696429,  14796184,   7908725,  -1644455, -10643353, -16054795,
-16274424, -12431097,  -5652074,   2461729,   9994176,  15166424,  16757007,  14390298,
  8625213,    823219,  -7173184, -13475586, -16595628, -15796488, -11266890,  -4076531,
  4076531,  11266890,  15796488,  16595628,  13475586,   7173184,   -823219,  -8625213,
-14390298, -16757007, -15166424,  -9994176,  -2461729,   5652074,  12431097,  16274424,
-16454846, -13949745,  -9320922,  -3273072,   3273072,   9320922,  13949745,  16454846,
 16454846,  13949745,   9320922,   3273072,  -3273072,  -9320922, -13949745, -16454846,
-16454846, -13949745,  -9320922,  -3273072,   3273072,   9320922,  13949745,  16454846,
 16454846,  13949745,   9320922,   3273072,  -3273072,  -9320922, -13949745, -16454846,
-16595628, -15166424, -12431097,  -8625213,  -4076531,    823219,   5652074,   9994176,
 13475586,  15796488,  16757007,  16274424,  14390298,  11266890,   7173184,   2461729,
 -2461729,  -7173184, -11266890, -14390298, -16274424, -16757007, -15796488, -13475586,
 -9994176,  -5652074,   -823219,   4076531,   8625213,  12431097,  15166424,  16595628,
-16696429, -16054795, -14796184, -12968963, -10643353,  -7908725,  -4870169,  -1644455,
  1644455,   4870169,   7908725,  10643353,  12968963,  14796184,  16054795,  16696429,
 16696429,  16054795,  14796184,  12968963,  10643353,   7908725,   4870169,   1644455,
 -1644455,  -4870169,  -7908725, -10643353, -12968963, -14796184, -16054795, -16696429,
-16757007, -16595628, -16274424, -15796488, -15166424, -14390298, -13475586, -12431097,
-11266890,  -9994176,  -8625213,  -7173184,  -5652074,  -4076531,  -2461729,   -823219,
   823219,   2461729,   4076531,   5652074,   7173184,   8625213,   9994176,  11266890,
 12431097,  13475586,  14390298,  15166424,  15796488,  16274424,  16595628,  16757007
};

/* Q24 fixed point format */
static const int Qwindow[512] =		/*window for synth*/
{
        0,      -256,      -256,      -256,      -256,      -256,      -256,      -512,
     -512,      -512,      -512,      -768,      -768,     -1024,     -1024,     -1280,
    -1280,     -1536,     -1792,     -1792,     -2048,     -2304,     -2560,     -2816,
    -3328,     -3584,     -4096,     -4352,     -4864,     -5376,     -6144,     -6656,
    -7424,     -7936,     -8960,     -9728,    -10496,    -11520,    -12544,    -13568,
   -14848,    -16128,    -17408,    -18688,    -20224,    -21760,    -23296,    -24832,
   -26624,    -28416,    -29952,    -32000,    -33792,    -35584,    -37632,    -39424,
   -41216,    -43264,    -45056,    -46848,    -48640,    -50176,    -51712,    -53248,
    54528,     55808,     56832,     57600,     58112,     58368,     58368,     58112,
    57344,     56576,     55040,     53248,     51200,     48384,     45312,     41728,
    37376,     32512,     27136,     21248,     14592,      7424,      -512,     -9216,
   -18432,    -28416,    -39168,    -50432,    -62464,    -75264,    -88832,   -102656,
  -117504,   -132864,   -148736,   -165120,   -182016,   -199424,   -217088,   -235264,
  -253696,   -272384,   -291072,   -309760,   -328448,   -347136,   -365568,   -383488,
  -401152,   -418304,   -434688,   -450304,   -465152,   -478720,   -491264,   -502272,
  -512256,   -520192,   -526592,   -531200,   -533760,   -534272,   -532480,   -528128,
   521472,    512000,    499712,    484608,    466432,    445184,    420864,    392960,
   361984,    327680,    289536,    248320,    203264,    154880,    102912,     47360,
   -11520,    -73728,   -139520,   -208384,   -280320,   -355328,   -433152,   -513536,
  -596480,   -681728,   -769024,   -857856,   -948480,  -1040128,  -1132800,  -1225728,
 -1319168,  -1412352,  -1505024,  -1596672,  -1686784,  -1775360,  -1861376,  -1944832,
 -2024960,  -2101504,  -2173696,  -2241280,  -2303488,  -2360064,  -2410496,  -2453760,
 -2490112,  -2518528,  -2538496,  -2549504,  -2551296,  -2543360,  -2524928,  -2496000,
 -2455552,  -2403584,  -2339584,  -2263040,  -2173952,  -2071552,  -1955840,  -1826304,
  1682944,   1525504,   1353728,   1167616,    966656,    751360,    521472,    276992,
    17920,   -255488,   -543232,   -844800,  -1160448,  -1489408,  -1831424,  -2186240,
 -2553600,  -2932480,  -3322880,  -3724288,  -4135680,  -4556544,  -4986368,  -5424384,
 -5869824,  -6321664,  -6779392,  -7241984,  -7708672,  -8178432,  -8650496,  -9123840,
 -9597184, -10070016, -10541056, -11009536, -11474176, -11933952, -12387840, -12835072,
-13274368, -13704704, -14125568, -14535168, -14933248, -15318528, -15689984, -16047104,
-16388864, -16714240, -17022464, -17313024, -17585152, -17837824, -18071040, -18283520,
-18475264, -18645760, -18794240, -18920448, -19024128, -19105280, -19163136, -19197952,
 19209728,  19197952,  19163136,  19105280,  19024128,  18920448,  18794240,  18645760,
 18475264,  18283520,  18071040,  17837824,  17585152,  17313024,  17022464,  16714240,
 16388864,  16047104,  15689984,  15318528,  14933248,  14535168,  14125568,  13704704,
 13274368,  12835072,  12387840,  11933952,  11474176,  11009536,  10541056,  10070016,
  9597184,   9123840,   8650496,   8178432,   7708672,   7241984,   6779392,   6321664,
  5869824,   5424384,   4986368,   4556544,   4135680,   3724288,   3322880,   2932480,
  2553600,   2186240,   1831424,   1489408,   1160448,    844800,    543232,    255488,
   -17920,   -276992,   -521472,   -751360,   -966656,  -1167616,  -1353728,  -1525504,
  1682944,   1826304,   1955840,   2071552,   2173952,   2263040,   2339584,   2403584,
  2455552,   2496000,   2524928,   2543360,   2551296,   2549504,   2538496,   2518528,
  2490112,   2453760,   2410496,   2360064,   2303488,   2241280,   2173696,   2101504,
  2024960,   1944832,   1861376,   1775360,   1686784,   1596672,   1505024,   1412352,
  1319168,   1225728,   1132800,   1040128,    948480,    857856,    769024,    681728,
   596480,    513536,    433152,    355328,    280320,    208384,    139520,     73728,
    11520,    -47360,   -102912,   -154880,   -203264,   -248320,   -289536,   -327680,
  -361984,   -392960,   -420864,   -445184,   -466432,   -484608,   -499712,   -512000,
   521472,    528128,    532480,    534272,    533760,    531200,    526592,    520192,
   512256,    502272,    491264,    478720,    465152,    450304,    434688,    418304,
   401152,    383488,    365568,    347136,    328448,    309760,    291072,    272384,
   253696,    235264,    217088,    199424,    182016,    165120,    148736,    132864,
   117504,    102656,     88832,     75264,     62464,     50432,     39168,     28416,
    18432,      9216,       512,     -7424,    -14592,    -21248,    -27136,    -32512,
   -37376,    -41728,    -45312,    -48384,    -51200,    -53248,    -55040,    -56576,
   -57344,    -58112,    -58368,    -58368,    -58112,    -57600,    -56832,    -55808,
    54528,     53248,     51712,     50176,     48640,     46848,     45056,     43264,
    41216,     39424,     37632,     35584,     33792,     32000,     29952,     28416,
    26624,     24832,     23296,     21760,     20224,     18688,     17408,     16128,
    14848,     13568,     12544,     11520,     10496,      9728,      8960,      7936,
     7424,      6656,      6144,      5376,      4864,      4352,      4096,      3584,
     3328,      2816,      2560,      2304,      2048,      1792,      1792,      1536,
     1280,      1280,      1024,      1024,       768,       768,       512,       512,
      512,       512,       256,       256,       256,       256,       256,       256
};


IppStatus __STDCALL 
ippsSynthPQMF_MP3_32s16s_c(Ipp32s* pSrcY, Ipp16s* pDstAudioOut, Ipp32s*
						 pVBuffer, int* pVPosition, int mode)
{
#ifdef KINOMA_SYNTH
	int i, j,k,tmp; 
	__int64 sum; 
	const int *pFilter;

	int  *pVBuf;

	if (!pSrcY || !pDstAudioOut || !pVBuffer || !pVPosition)
		return ippStsNullPtrErr;

	//if ((mode < 1 || mode > 2) || (*pVPosition < 0 || *pVPosition > 15))
	if ((mode < 1 || mode > 2) || (*pVPosition < 0 || *pVPosition > 1023))
		return ippStsBadArgErr;

	pVBuf = pVBuffer + *pVPosition;

	/* fast 32 IMDCT in synthPQMF*/
	pFilter = Qfilter; //fastFilter;
	for (i = 0; i < 16; i++)
	{
		sum = 0;
		for (j = 0; j < 32; j++)
		{
			sum += (__int64)pFilter[j] * pSrcY[j];

		}
		pVBuf[i] = (int)(sum >> 24);
		pVBuf[32-i] =  (int)(-(sum>> 24)) ;
		pFilter += 32;
	}
	pVBuf[16] = 0;
	for (i = 33; i < 48; i++)
	{
		sum = 0;
		for (j = 0; j < 32; j++)
		{
			sum += (__int64)pFilter[j] * pSrcY[j];
		}
		pVBuf[96-i] = pVBuf[i] = (int)(sum >> 24);
		pFilter += 32;
	}
	sum = 0;
	for (i = 0; i < 32; i++)
	{
		sum += (__int64)pSrcY[i];
	}
	pVBuf[48] = (int)(-sum);
	/* fast IMDCT end */

	pVBuf = pVBuffer;


	/* following is the merged processing of two steps discribed in spec.*/
    for (j=0; j<32; j++) 
	{
        sum = 0;
        for (i=0; i<16; i++) 
		{
            k = j + (i<<5);
            sum += (__int64)Qwindow[k] * pVBuf[(k + (((i+1)>>1)<<6) + *pVPosition) & 0x3ff];
        }

		tmp = (int)((sum+4294967296ll)>>33);  /*  ==  ( / 2^48) * 32768  */
		pDstAudioOut[j*mode] = (Ipp16s)CLIP_R(tmp,MAX_16S,MIN_16S);
	}

	//	update the position of Vbuffer pointer
	*pVPosition = (*pVPosition - 64) & 0x3ff;

#endif

#ifdef PRINT_REF_INFO
	//dump("ippsSynthPQMF_MP3_32s16s",-1);
#endif

#ifdef INTEL_SYNTH
	{
		IppStatus sts;
		sts = ippsSynthPQMF_MP3_32s16s(pSrcY, pDstAudioOut, pVBuffer, pVPosition, mode);
		return sts;
	}
#endif

	return ippStsNoErr;
}



//IppStatus __STDCALL 
//ippsSynthPQMF_MP3_32s16s_c(Ipp32s* pSrcY, Ipp16s* pDstAudioOut, Ipp32s*
//						 pVBuffer, int* pVPosition, int mode)
//{
//#ifdef KINOMA_SYNTH
//	int i, j,k,tmp; 
//	__int64 sum; 
//	int *pFilter;
//
//	//the pVBuffer is a 512/channel buffer, but in 11172-3 spec, the algorithm need 1024/channel,
//	//I don't know what algorithm intel use 512/channel to implement this function, so I have to declare two 1024
//	//static buffer for my implementation.
//	static int VBuf1[1024],VBuf2[1024];		
//	static int pchan;
//	static int pos1, pos2;
//	static int init = 1;
//	int *pVBufTmp,  *pVBuf;
//	int chan, pos;
//
//	if (!pSrcY || !pDstAudioOut || !pVBuffer || !pVPosition)
//		return ippStsNullPtrErr;
//
//	if ((mode < 1 || mode > 2) || (*pVPosition < 0 || *pVPosition > 15))
//		return ippStsBadArgErr;
//
//	if (init)
//	{
//		memset(VBuf1,0,1024*sizeof(int));
//		memset(VBuf2,0,1024*sizeof(int));
//		init = 0;
//		pchan = pVBuffer;
//		pos1 = 0;
//		pos2 = 0;
//
//		chan = 1;
//		pos = 0;
//	}
//	if (pchan == pVBuffer)
//	{
//		chan = 1;
//		pVBufTmp = VBuf1;
//		pos = pos1;
//	}
//	else
//	{
//		chan = 2;
//		pVBufTmp = VBuf2;
//		pos = pos2;
//	}
//
//	pVBuf = pVBufTmp + pos;
//
//	/* fast 32 IMDCT in synthPQMF*/
//	pFilter = Qfilter; //fastFilter;
//	for (i = 0; i < 16; i++)
//	{
//		sum = 0;
//		for (j = 0; j < 32; j++)
//		{
//			sum += (__int64)pFilter[j] * pSrcY[j];
//
//		}
//		pVBuf[i] = sum >> 24;
//		pVBuf[32-i] =  -(sum>> 24) ;
//		pFilter += 32;
//	}
//	pVBuf[16] = 0;
//	for (i = 33; i < 48; i++)
//	{
//		sum = 0;
//		for (j = 0; j < 32; j++)
//		{
//			sum += (__int64)pFilter[j] * pSrcY[j];
//		}
//		pVBuf[96-i] = pVBuf[i] = sum >> 24;
//		pFilter += 32;
//	}
//	sum = 0;
//	for (i = 0; i < 32; i++)
//	{
//		sum += (__int64)pSrcY[i];
//	}
//	pVBuf[48] = -sum;
//	/* fast IMDCT end */
//
//	pVBuf = pVBufTmp;
//
//
//	/* following is the merged processing of two steps discribed in spec.*/
//    for (j=0; j<32; j++) 
//	{
//        sum = 0;
//        for (i=0; i<16; i++) 
//		{
//            k = j + (i<<5);
//            sum += (__int64)Qwindow[k] * pVBuf[(k + (((i+1)>>1)<<6) + pos) & 0x3ff];
//        }
//
//		tmp = (sum+4294967296)>>33;  /*  ==  ( / 2^48) * 32768  */
//		pDstAudioOut[j*mode] = (Ipp16s)CLIP_R(tmp,MAX_16S,MIN_16S);
//	}
//
//	//	update the position of Vbuffer pointer
//	if (chan ==1)
//		pos1 = (pos1 - 64) & 0x3ff;
//	else
//		pos2 = (pos2 - 64) & 0x3ff;
//	//	
//	
//#endif
//
//#ifdef PRINT_REF_INFO
//	dump("ippsSynthPQMF_MP3_32s16s",-1);
//#endif
//
//#ifdef INTEL_SYNTH
//	{
//		IppStatus sts;
//		sts = ippsSynthPQMF_MP3_32s16s(pSrcY, pDstAudioOut, pVBuffer, pVPosition, mode);
//		return sts;
//	}
//#endif
//
//	return ippStsNoErr;
//}



// following is the old floating point , obsolete

//static const double fastFilter[] =		/*filters of Nik, about half coeffs of full coeffs for fast IMDCT */
//{
// 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
// 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
// 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
// 0.707106781, -0.707106781, -0.707106781,  0.707106781, 0.707106781, -0.707106781, -0.707106781,  0.707106781,
// 0.671558955, -0.803207531, -0.514102744,  0.903989293, 0.336889853, -0.970031253, -0.146730474,  0.998795456,
//-0.049067674, -0.989176510,  0.242980180,  0.941544065,-0.427555093, -0.857728610,  0.595699304,  0.740951125,
//-0.740951125, -0.595699304,  0.857728610,  0.427555093,-0.941544065, -0.242980180,  0.989176510,  0.049067674,
//-0.998795456,  0.146730474,  0.970031253, -0.336889853,-0.903989293,  0.514102744,  0.803207531, -0.671558955,
// 0.634393284, -0.881921264, -0.290284677,  0.995184727,-0.098017140, -0.956940336,  0.471396737,  0.773010453,
//-0.773010453, -0.471396737,  0.956940336,  0.098017140,-0.995184727,  0.290284677,  0.881921264, -0.634393284,
//-0.634393284,  0.881921264,  0.290284677, -0.995184727, 0.098017140,  0.956940336, -0.471396737, -0.773010453,
// 0.773010453,  0.471396737, -0.956940336, -0.098017140, 0.995184727, -0.290284677, -0.881921264,  0.634393284,
// 0.595699304, -0.941544065, -0.049067674,  0.970031253,-0.514102744, -0.671558955,  0.903989293,  0.146730474,
//-0.989176510,  0.427555093,  0.740951125, -0.857728610,-0.242980180,  0.998795456, -0.336889853, -0.803207531,
// 0.803207531,  0.336889853, -0.998795456,  0.242980180, 0.857728610, -0.740951125, -0.427555093,  0.989176510,
//-0.146730474, -0.903989293,  0.671558955,  0.514102744,-0.970031253,  0.049067674,  0.941544065, -0.595699304,
// 0.555570233, -0.980785280,  0.195090322,  0.831469612,-0.831469612, -0.195090322,  0.980785280, -0.555570233,
//-0.555570233,  0.980785280, -0.195090322, -0.831469612, 0.831469612,  0.195090322, -0.980785280,  0.555570233,
// 0.555570233, -0.980785280,  0.195090322,  0.831469612,-0.831469612, -0.195090322,  0.980785280, -0.555570233,
//-0.555570233,  0.980785280, -0.195090322, -0.831469612, 0.831469612,  0.195090322, -0.980785280,  0.555570233,
// 0.514102744, -0.998795456,  0.427555093,  0.595699304,-0.989176510,  0.336889853,  0.671558955, -0.970031253,
// 0.242980180,  0.740951125, -0.941544065,  0.146730474, 0.803207531, -0.903989293,  0.049067674,  0.857728610,
//-0.857728610, -0.049067674,  0.903989293, -0.803207531,-0.146730474,  0.941544065, -0.740951125, -0.242980180,
// 0.970031253, -0.671558955, -0.336889853,  0.989176510,-0.595699304, -0.427555093,  0.998795456, -0.514102744,
// 0.471396737, -0.995184727,  0.634393284,  0.290284677,-0.956940336,  0.773010453,  0.098017140, -0.881921264,
// 0.881921264, -0.098017140, -0.773010453,  0.956940336,-0.290284677, -0.634393284,  0.995184727, -0.471396737,
//-0.471396737,  0.995184727, -0.634393284, -0.290284677, 0.956940336, -0.773010453, -0.098017140,  0.881921264,
//-0.881921264,  0.098017140,  0.773010453, -0.956940336, 0.290284677,  0.634393284, -0.995184727,  0.471396737,
// 0.427555093, -0.970031253,  0.803207531, -0.049067674,-0.740951125,  0.989176510, -0.514102744, -0.336889853,
// 0.941544065, -0.857728610,  0.146730474,  0.671558955,-0.998795456,  0.595699304,  0.242980180, -0.903989293,
// 0.903989293, -0.242980180, -0.595699304,  0.998795456,-0.671558955, -0.146730474,  0.857728610, -0.941544065,
// 0.336889853,  0.514102744, -0.989176510,  0.740951125, 0.049067674, -0.803207531,  0.970031253, -0.427555093,
// 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
// 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
// 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
// 0.382683432, -0.923879533,  0.923879533, -0.382683432,-0.382683432,  0.923879533, -0.923879533,  0.382683432,
// 0.336889853, -0.857728610,  0.989176510, -0.671558955, 0.049067674,  0.595699304, -0.970031253,  0.903989293,
//-0.427555093, -0.242980180,  0.803207531, -0.998795456, 0.740951125, -0.146730474, -0.514102744,  0.941544065,
//-0.941544065,  0.514102744,  0.146730474, -0.740951125, 0.998795456, -0.803207531,  0.242980180,  0.427555093,
//-0.903989293,  0.970031253, -0.595699304, -0.049067674, 0.671558955, -0.989176510,  0.857728610, -0.336889853,
// 0.290284677, -0.773010453,  0.995184727, -0.881921264, 0.471396737,  0.098017140, -0.634393284,  0.956940336,
//-0.956940336,  0.634393284, -0.098017140, -0.471396737, 0.881921264, -0.995184727,  0.773010453, -0.290284677,
//-0.290284677,  0.773010453, -0.995184727,  0.881921264,-0.471396737, -0.098017140,  0.634393284, -0.956940336,
// 0.956940336, -0.634393284,  0.098017140,  0.471396737,-0.881921264,  0.995184727, -0.773010453,  0.290284677,
// 0.242980180, -0.671558955,  0.941544065, -0.989176510, 0.803207531, -0.427555093, -0.049067674,  0.514102744,
//-0.857728610,  0.998795456, -0.903989293,  0.595699304,-0.146730474, -0.336889853,  0.740951125, -0.970031253,
// 0.970031253, -0.740951125,  0.336889853,  0.146730474,-0.595699304,  0.903989293, -0.998795456,  0.857728610,
//-0.514102744,  0.049067674,  0.427555093, -0.803207531, 0.989176510, -0.941544065,  0.671558955, -0.242980180,
// 0.195090322, -0.555570233,  0.831469612, -0.980785280, 0.980785280, -0.831469612,  0.555570233, -0.195090322,
//-0.195090322,  0.555570233, -0.831469612,  0.980785280,-0.980785280,  0.831469612, -0.555570233,  0.195090322,
// 0.195090322, -0.555570233,  0.831469612, -0.980785280, 0.980785280, -0.831469612,  0.555570233, -0.195090322,
//-0.195090322,  0.555570233, -0.831469612,  0.980785280,-0.980785280,  0.831469612, -0.555570233,  0.195090322,
// 0.146730474, -0.427555093,  0.671558955, -0.857728610, 0.970031253, -0.998795456,  0.941544065, -0.803207531,
// 0.595699304, -0.336889853,  0.049067674,  0.242980180,-0.514102744,  0.740951125, -0.903989293,  0.989176510,
//-0.989176510,  0.903989293, -0.740951125,  0.514102744,-0.242980180, -0.049067674,  0.336889853, -0.595699304,
// 0.803207531, -0.941544065,  0.998795456, -0.970031253, 0.857728610, -0.671558955,  0.427555093, -0.146730474,
// 0.098017140, -0.290284677,  0.471396737, -0.634393284, 0.773010453, -0.881921264,  0.956940336, -0.995184727,
// 0.995184727, -0.956940336,  0.881921264, -0.773010453, 0.634393284, -0.471396737,  0.290284677, -0.098017140,
//-0.098017140,  0.290284677, -0.471396737,  0.634393284,-0.773010453,  0.881921264, -0.956940336,  0.995184727,
//-0.995184727,  0.956940336, -0.881921264,  0.773010453,-0.634393284,  0.471396737, -0.290284677,  0.098017140,
// 0.049067674, -0.146730474,  0.242980180, -0.336889853, 0.427555093, -0.514102744,  0.595699304, -0.671558955,
// 0.740951125, -0.803207531,  0.857728610, -0.903989293, 0.941544065, -0.970031253,  0.989176510, -0.998795456,
// 0.998795456, -0.989176510,  0.970031253, -0.941544065, 0.903989293, -0.857728610,  0.803207531, -0.740951125,
// 0.671558955, -0.595699304,  0.514102744, -0.427555093, 0.336889853, -0.242980180,  0.146730474, -0.049067674,
//-0.740951125,  0.595699304,  0.857728610, -0.427555093,-0.941544065,  0.242980180,  0.989176510, -0.049067674,
//-0.998795456, -0.146730474,  0.970031253,  0.336889853,-0.903989293, -0.514102744,  0.803207531,  0.671558955,
//-0.671558955, -0.803207531,  0.514102744,  0.903989293,-0.336889853, -0.970031253,  0.146730474,  0.998795456,
// 0.049067674, -0.989176510, -0.242980180,  0.941544065, 0.427555093, -0.857728610, -0.595699304,  0.740951125,
//-0.773010453,  0.471396737,  0.956940336, -0.098017140,-0.995184727, -0.290284677,  0.881921264,  0.634393284,
//-0.634393284, -0.881921264,  0.290284677,  0.995184727, 0.098017140, -0.956940336, -0.471396737,  0.773010453,
// 0.773010453, -0.471396737, -0.956940336,  0.098017140, 0.995184727,  0.290284677, -0.881921264, -0.634393284,
// 0.634393284,  0.881921264, -0.290284677, -0.995184727,-0.098017140,  0.956940336,  0.471396737, -0.773010453,
//-0.803207531,  0.336889853,  0.998795456,  0.242980180,-0.857728610, -0.740951125,  0.427555093,  0.989176510,
// 0.146730474, -0.903989293, -0.671558955,  0.514102744, 0.970031253,  0.049067674, -0.941544065, -0.595699304,
// 0.595699304,  0.941544065, -0.049067674, -0.970031253,-0.514102744,  0.671558955,  0.903989293, -0.146730474,
//-0.989176510, -0.427555093,  0.740951125,  0.857728610,-0.242980180, -0.998795456, -0.336889853,  0.803207531,
//-0.831469612,  0.195090322,  0.980785280,  0.555570233,-0.555570233, -0.980785280, -0.195090322,  0.831469612,
// 0.831469612, -0.195090322, -0.980785280, -0.555570233, 0.555570233,  0.980785280,  0.195090322, -0.831469612,
//-0.831469612,  0.195090322,  0.980785280,  0.555570233,-0.555570233, -0.980785280, -0.195090322,  0.831469612,
// 0.831469612, -0.195090322, -0.980785280, -0.555570233, 0.555570233,  0.980785280,  0.195090322, -0.831469612,
//-0.857728610,  0.049067674,  0.903989293,  0.803207531,-0.146730474, -0.941544065, -0.740951125,  0.242980180,
// 0.970031253,  0.671558955, -0.336889853, -0.989176510,-0.595699304,  0.427555093,  0.998795456,  0.514102744,
//-0.514102744, -0.998795456, -0.427555093,  0.595699304, 0.989176510,  0.336889853, -0.671558955, -0.970031253,
//-0.242980180,  0.740951125,  0.941544065,  0.146730474,-0.803207531, -0.903989293, -0.049067674,  0.857728610,
//-0.881921264, -0.098017140,  0.773010453,  0.956940336, 0.290284677, -0.634393284, -0.995184727, -0.471396737,
// 0.471396737,  0.995184727,  0.634393284, -0.290284677,-0.956940336, -0.773010453,  0.098017140,  0.881921264,
// 0.881921264,  0.098017140, -0.773010453, -0.956940336,-0.290284677,  0.634393284,  0.995184727,  0.471396737,
//-0.471396737, -0.995184727, -0.634393284,  0.290284677, 0.956940336,  0.773010453, -0.098017140, -0.881921264,
//-0.903989293, -0.242980180,  0.595699304,  0.998795456, 0.671558955, -0.146730474, -0.857728610, -0.941544065,
//-0.336889853,  0.514102744,  0.989176510,  0.740951125,-0.049067674, -0.803207531, -0.970031253, -0.427555093,
// 0.427555093,  0.970031253,  0.803207531,  0.049067674,-0.740951125, -0.989176510, -0.514102744,  0.336889853,
// 0.941544065,  0.857728610,  0.146730474, -0.671558955,-0.998795456, -0.595699304,  0.242980180,  0.903989293,
//-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
//-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
//-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
//-0.923879533, -0.382683432,  0.382683432,  0.923879533, 0.923879533,  0.382683432, -0.382683432, -0.923879533,
//-0.941544065, -0.514102744,  0.146730474,  0.740951125, 0.998795456,  0.803207531,  0.242980180, -0.427555093,
//-0.903989293, -0.970031253, -0.595699304,  0.049067674, 0.671558955,  0.989176510,  0.857728610,  0.336889853,
//-0.336889853, -0.857728610, -0.989176510, -0.671558955,-0.049067674,  0.595699304,  0.970031253,  0.903989293,
// 0.427555093, -0.242980180, -0.803207531, -0.998795456,-0.740951125, -0.146730474,  0.514102744,  0.941544065,
//-0.956940336, -0.634393284, -0.098017140,  0.471396737, 0.881921264,  0.995184727,  0.773010453,  0.290284677,
//-0.290284677, -0.773010453, -0.995184727, -0.881921264,-0.471396737,  0.098017140,  0.634393284,  0.956940336,
// 0.956940336,  0.634393284,  0.098017140, -0.471396737,-0.881921264, -0.995184727, -0.773010453, -0.290284677,
// 0.290284677,  0.773010453,  0.995184727,  0.881921264, 0.471396737, -0.098017140, -0.634393284, -0.956940336,
//-0.970031253, -0.740951125, -0.336889853,  0.146730474, 0.595699304,  0.903989293,  0.998795456,  0.857728610,
// 0.514102744,  0.049067674, -0.427555093, -0.803207531,-0.989176510, -0.941544065, -0.671558955, -0.242980180,
// 0.242980180,  0.671558955,  0.941544065,  0.989176510, 0.803207531,  0.427555093, -0.049067674, -0.514102744,
//-0.857728610, -0.998795456, -0.903989293, -0.595699304,-0.146730474,  0.336889853,  0.740951125,  0.970031253,
//-0.980785280, -0.831469612, -0.555570233, -0.195090322, 0.195090322,  0.555570233,  0.831469612,  0.980785280,
// 0.980785280,  0.831469612,  0.555570233,  0.195090322,-0.195090322, -0.555570233, -0.831469612, -0.980785280,
//-0.980785280, -0.831469612, -0.555570233, -0.195090322, 0.195090322,  0.555570233,  0.831469612,  0.980785280,
// 0.980785280,  0.831469612,  0.555570233,  0.195090322,-0.195090322, -0.555570233, -0.831469612, -0.980785280,
//-0.989176510, -0.903989293, -0.740951125, -0.514102744,-0.242980180,  0.049067674,  0.336889853,  0.595699304,
// 0.803207531,  0.941544065,  0.998795456,  0.970031253, 0.857728610,  0.671558955,  0.427555093,  0.146730474,
//-0.146730474, -0.427555093, -0.671558955, -0.857728610,-0.970031253, -0.998795456, -0.941544065, -0.803207531,
//-0.595699304, -0.336889853, -0.049067674,  0.242980180, 0.514102744,  0.740951125,  0.903989293,  0.989176510,
//-0.995184727, -0.956940336, -0.881921264, -0.773010453,-0.634393284, -0.471396737, -0.290284677, -0.098017140,
// 0.098017140,  0.290284677,  0.471396737,  0.634393284, 0.773010453,  0.881921264,  0.956940336,  0.995184727,
// 0.995184727,  0.956940336,  0.881921264,  0.773010453, 0.634393284,  0.471396737,  0.290284677,  0.098017140,
//-0.098017140, -0.290284677, -0.471396737, -0.634393284,-0.773010453, -0.881921264, -0.956940336, -0.995184727,
//-0.998795456, -0.989176510, -0.970031253, -0.941544065,-0.903989293, -0.857728610, -0.803207531, -0.740951125,
//-0.671558955, -0.595699304, -0.514102744, -0.427555093,-0.336889853, -0.242980180, -0.146730474, -0.049067674,
// 0.049067674,  0.146730474,  0.242980180,  0.336889853, 0.427555093,  0.514102744,  0.595699304,  0.671558955,
// 0.740951125,  0.803207531,  0.857728610,  0.903989293, 0.941544065,  0.970031253,  0.989176510,  0.998795456
//};
//
//static const double window[512] =		/*window for synth*/
//{
// 0.000000000, -0.000015259, -0.000015259, -0.000015259,-0.000015259, -0.000015259, -0.000015259, -0.000030518,
//-0.000030518, -0.000030518, -0.000030518, -0.000045776,-0.000045776, -0.000061035, -0.000061035, -0.000076294,
//-0.000076294, -0.000091553, -0.000106812, -0.000106812,-0.000122070, -0.000137329, -0.000152588, -0.000167847,
//-0.000198364, -0.000213623, -0.000244141, -0.000259399,-0.000289917, -0.000320435, -0.000366211, -0.000396729,
//-0.000442505, -0.000473022, -0.000534058, -0.000579834,-0.000625610, -0.000686646, -0.000747681, -0.000808716,
//-0.000885010, -0.000961304, -0.001037598, -0.001113892,-0.001205444, -0.001296997, -0.001388550, -0.001480103,
//-0.001586914, -0.001693726, -0.001785278, -0.001907349,-0.002014160, -0.002120972, -0.002243042, -0.002349854,
//-0.002456665, -0.002578735, -0.002685547, -0.002792358,-0.002899170, -0.002990723, -0.003082275, -0.003173828,
// 0.003250122,  0.003326416,  0.003387451,  0.003433228, 0.003463745,  0.003479004,  0.003479004,  0.003463745,
// 0.003417969,  0.003372192,  0.003280640,  0.003173828, 0.003051758,  0.002883911,  0.002700806,  0.002487183,
// 0.002227783,  0.001937866,  0.001617432,  0.001266479, 0.000869751,  0.000442505, -0.000030518, -0.000549316,
//-0.001098633, -0.001693726, -0.002334595, -0.003005981,-0.003723145, -0.004486084, -0.005294800, -0.006118774,
//-0.007003784, -0.007919312, -0.008865356, -0.009841919,-0.010848999, -0.011886597, -0.012939453, -0.014022827,
//-0.015121460, -0.016235352, -0.017349243, -0.018463135,-0.019577026, -0.020690918, -0.021789551, -0.022857666,
//-0.023910522, -0.024932861, -0.025909424, -0.026840210,-0.027725220, -0.028533936, -0.029281616, -0.029937744,
//-0.030532837, -0.031005859, -0.031387329, -0.031661987,-0.031814575, -0.031845093, -0.031738281, -0.031478882,
// 0.031082153,  0.030517578,  0.029785156,  0.028884888, 0.027801514,  0.026535034,  0.025085449,  0.023422241,
// 0.021575928,  0.019531250,  0.017257690,  0.014801025, 0.012115479,  0.009231567,  0.006134033,  0.002822876,
//-0.000686646, -0.004394531, -0.008316040, -0.012420654,-0.016708374, -0.021179199, -0.025817871, -0.030609131,
//-0.035552979, -0.040634155, -0.045837402, -0.051132202,-0.056533813, -0.061996460, -0.067520142, -0.073059082,
//-0.078628540, -0.084182739, -0.089706421, -0.095169067,-0.100540161, -0.105819702, -0.110946655, -0.115921021,
//-0.120697021, -0.125259399, -0.129562378, -0.133590698,-0.137298584, -0.140670776, -0.143676758, -0.146255493,
//-0.148422241, -0.150115967, -0.151306152, -0.151962280,-0.152069092, -0.151596069, -0.150497437, -0.148773193,
//-0.146362305, -0.143264771, -0.139450073, -0.134887695,-0.129577637, -0.123474121, -0.116577148, -0.108856201,
// 0.100311279,  0.090927124,  0.080688477,  0.069595337, 0.057617187,  0.044784546,  0.031082153,  0.016510010,
// 0.001068115, -0.015228271, -0.032379150, -0.050354004,-0.069168091, -0.088775635, -0.109161377, -0.130310059,
//-0.152206421, -0.174789429, -0.198059082, -0.221984863,-0.246505737, -0.271591187, -0.297210693, -0.323318481,
//-0.349868774, -0.376800537, -0.404083252, -0.431655884,-0.459472656, -0.487472534, -0.515609741, -0.543823242,
//-0.572036743, -0.600219727, -0.628295898, -0.656219482,-0.683914185, -0.711318970, -0.738372803, -0.765029907,
//-0.791213989, -0.816864014, -0.841949463, -0.866363525,-0.890090942, -0.913055420, -0.935195923, -0.956481934,
//-0.976852417, -0.996246338, -1.014617920, -1.031936646,-1.048156738, -1.063217163, -1.077117920, -1.089782715,
//-1.101211548, -1.111373901, -1.120223999, -1.127746582,-1.133926392, -1.138763428, -1.142211914, -1.144287109,
// 1.144989014,  1.144287109,  1.142211914,  1.138763428, 1.133926392,  1.127746582,  1.120223999,  1.111373901,
// 1.101211548,  1.089782715,  1.077117920,  1.063217163, 1.048156738,  1.031936646,  1.014617920,  0.996246338,
// 0.976852417,  0.956481934,  0.935195923,  0.913055420, 0.890090942,  0.866363525,  0.841949463,  0.816864014,
// 0.791213989,  0.765029907,  0.738372803,  0.711318970, 0.683914185,  0.656219482,  0.628295898,  0.600219727,
// 0.572036743,  0.543823242,  0.515609741,  0.487472534, 0.459472656,  0.431655884,  0.404083252,  0.376800537,
// 0.349868774,  0.323318481,  0.297210693,  0.271591187, 0.246505737,  0.221984863,  0.198059082,  0.174789429,
// 0.152206421,  0.130310059,  0.109161377,  0.088775635, 0.069168091,  0.050354004,  0.032379150,  0.015228271,
//-0.001068115, -0.016510010, -0.031082153, -0.044784546,-0.057617187, -0.069595337, -0.080688477, -0.090927124,
// 0.100311279,  0.108856201,  0.116577148,  0.123474121, 0.129577637,  0.134887695,  0.139450073,  0.143264771,
// 0.146362305,  0.148773193,  0.150497437,  0.151596069, 0.152069092,  0.151962280,  0.151306152,  0.150115967,
// 0.148422241,  0.146255493,  0.143676758,  0.140670776, 0.137298584,  0.133590698,  0.129562378,  0.125259399,
// 0.120697021,  0.115921021,  0.110946655,  0.105819702, 0.100540161,  0.095169067,  0.089706421,  0.084182739,
// 0.078628540,  0.073059082,  0.067520142,  0.061996460, 0.056533813,  0.051132202,  0.045837402,  0.040634155,
// 0.035552979,  0.030609131,  0.025817871,  0.021179199, 0.016708374,  0.012420654,  0.008316040,  0.004394531,
// 0.000686646, -0.002822876, -0.006134033, -0.009231567,-0.012115479, -0.014801025, -0.017257690, -0.019531250,
//-0.021575928, -0.023422241, -0.025085449, -0.026535034,-0.027801514, -0.028884888, -0.029785156, -0.030517578,
// 0.031082153,  0.031478882,  0.031738281,  0.031845093, 0.031814575,  0.031661987,  0.031387329,  0.031005859,
// 0.030532837,  0.029937744,  0.029281616,  0.028533936, 0.027725220,  0.026840210,  0.025909424,  0.024932861,
// 0.023910522,  0.022857666,  0.021789551,  0.020690918, 0.019577026,  0.018463135,  0.017349243,  0.016235352,
// 0.015121460,  0.014022827,  0.012939453,  0.011886597, 0.010848999,  0.009841919,  0.008865356,  0.007919312,
// 0.007003784,  0.006118774,  0.005294800,  0.004486084, 0.003723145,  0.003005981,  0.002334595,  0.001693726,
// 0.001098633,  0.000549316,  0.000030518, -0.000442505,-0.000869751, -0.001266479, -0.001617432, -0.001937866,
//-0.002227783, -0.002487183, -0.002700806, -0.002883911,-0.003051758, -0.003173828, -0.003280640, -0.003372192,
//-0.003417969, -0.003463745, -0.003479004, -0.003479004,-0.003463745, -0.003433228, -0.003387451, -0.003326416,
// 0.003250122,  0.003173828,  0.003082275,  0.002990723, 0.002899170,  0.002792358,  0.002685547,  0.002578735,
// 0.002456665,  0.002349854,  0.002243042,  0.002120972, 0.002014160,  0.001907349,  0.001785278,  0.001693726,
// 0.001586914,  0.001480103,  0.001388550,  0.001296997, 0.001205444,  0.001113892,  0.001037598,  0.000961304,
// 0.000885010,  0.000808716,  0.000747681,  0.000686646, 0.000625610,  0.000579834,  0.000534058,  0.000473022,
// 0.000442505,  0.000396729,  0.000366211,  0.000320435, 0.000289917,  0.000259399,  0.000244141,  0.000213623,
// 0.000198364,  0.000167847,  0.000152588,  0.000137329, 0.000122070,  0.000106812,  0.000106812,  0.000091553,
// 0.000076294,  0.000076294,  0.000061035,  0.000061035, 0.000045776,  0.000045776,  0.000030518,  0.000030518,
// 0.000030518,  0.000030518,  0.000015259,  0.000015259, 0.000015259,  0.000015259,  0.000015259,  0.000015259
//};
//
//
///* Q format ---> double float pointing number, used in ippsSynthPQMF_MP3_32s16s*/
//static __inline void QF2DP(Ipp32s *pSrc, double *pDst, int intbits, int fltbits, int len)		
//{
//	Ipp32s Mag = 1 << fltbits;
//	int i;
//	for (i = 0; i < len; i++)
//	{
//		pDst[i] = (double)pSrc[i] / Mag;
//	}
//
//}
//
//IppStatus __STDCALL 
//ippsSynthPQMF_MP3_32s16s_c(Ipp32s* pSrcY, Ipp16s* pDstAudioOut, Ipp32s*
//						 pVBuffer, int* pVPosition, int mode)
//{
//#ifdef KINOMA_SYNTH
//	int i, j,k,tmp; 
//	register double sum, *pFilter;
//
//	//the pVBuffer is a 512/channel buffer, but in 11172-3 spec, the algorithm need 1024/channel,
//	//I don't know what algorithm intel use 512/channel to implement this function, so I have to declare two 1024
//	//static buffer for my implementation.
//	static double VBuf1[1024],VBuf2[1024];		
//	static int pchan;
//	static int pos1, pos2;
//	static int init = 1;
//	double *pVBufTmp,  *pVBuf;
//	double src[32];
//	int chan, pos;
//
//	if (!pSrcY || !pDstAudioOut || !pVBuffer || !pVPosition)
//		return ippStsNullPtrErr;
//
//	if ((mode < 1 || mode > 2) || (*pVPosition < 0 || *pVPosition > 15))
//		return ippStsBadArgErr;
//	
//	if (init)
//	{
//		memset(VBuf1,0,1024*sizeof(double));
//		memset(VBuf2,0,1024*sizeof(double));
//		init = 0;
//		pchan = pVBuffer;
//		pos1 = 0;
//		pos2 = 0;
//
//		chan = 1;
//		pos = 0;
//	}
//	if (pchan == pVBuffer)
//	{
//		chan = 1;
//		pVBufTmp = VBuf1;
//		pos = pos1;
//	}
//	else
//	{
//		chan = 2;
//		pVBufTmp = VBuf2;
//		pos = pos2;
//	}
//
//	QF2DP(pSrcY, src,7,24,32);
//	pVBuf = pVBufTmp + pos;
//
//	/* fast 32 IMDCT in synthPQMF*/
//	pFilter = fastFilter;
//	for (i = 0; i < 16; i++)
//	{
//		sum = 0;
//		for (j = 0; j < 32; j++)
//		{
//			sum += pFilter[j] * src[j];
//
//		}
//		pVBuf[i] = sum;
//		pVBuf[32-i] = -sum;
//		pFilter += 32;
//	}
//	pVBuf[16] = 0;
//	for (i = 33; i < 48; i++)
//	{
//		sum = 0;
//		for (j = 0; j < 32; j++)
//		{
//			sum += pFilter[j] * src[j];
//		}
//		pVBuf[96-i] = pVBuf[i] = sum;
//		pFilter += 32;
//	}
//	sum = 0;
//	for (i = 0; i < 32; i++)
//	{
//		sum += src[i];
//	}
//	pVBuf[48] = -sum;
//	/* fast IMDCT end */
//
//	pVBuf = pVBufTmp;
//
//
//	/* following is the merged processing of two steps discribed in spec.*/
//    for (j=0; j<32; j++) 
//	{
//        sum = 0;
//        for (i=0; i<16; i++) 
//		{
//            k = j + (i<<5);
//            sum += window[k] * pVBuf[(k + (((i+1)>>1)<<6) + pos) & 0x3ff];
//        }
//		tmp = (int)(sum * 32768); // here round to zero, 
//		pDstAudioOut[j*mode] = (Ipp16s)CLIP_R(tmp,MAX_16S,MIN_16S);
//	}
//
//	//	update the position of Vbuffer pointer
//	if (chan ==1)
//		pos1 = (pos1 - 64) & 0x3ff;
//	else
//		pos2 = (pos2 - 64) & 0x3ff;
//	//	
//	
//#endif
//
//#ifdef PRINT_REF_INFO
//	dump("ippsSynthPQMF_MP3_32s16s",-1);
//#endif
//
//#ifdef INTEL_SYNTH
//	{
//		IppStatus sts;
//		sts = ippsSynthPQMF_MP3_32s16s(pSrcY, pDstAudioOut, pVBuffer, pVPosition, mode);
//		return sts;
//	}
//#endif
//
//	return ippStsNoErr;
//}
